(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e036f12"],{"105a":function(a,n,t){"use strict";t("1906")},1806:function(a,n,t){},1906:function(a,n,t){},"360c":function(a,n,t){"use strict";t("1806")},"4add":function(a,n,t){},"4e36":function(a,n,t){"use strict";t("e4ae")},"80eb":function(a,n,t){},8147:function(a,n,t){"use strict";t("80eb")},"8af5":function(a,n,t){},9229:function(a,n,t){"use strict";t.r(n);var e=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{attrs:{id:"page-container"}},[t("div",{staticClass:"grp-nhat-ky-chung"},[t("NhatKyChung",{attrs:{"popup-ref":a.popupRef}})],1),t("div",{staticClass:"grp-table"},["TAB_HACH_TOAN"===a.activeTab?t("HachToan",{attrs:{"popup-ref":a.popupRef}}):a._e(),"TAB_NHAP_VAT_TU"===a.activeTab?t("NhapVatTu",{attrs:{"popup-ref":a.popupRef}}):a._e(),"TAB_XUAT_VAT_TU"===a.activeTab?t("XuatVatTu",{attrs:{"popup-ref":a.popupRef}}):a._e(),"TAB_HOA_DON_MUA_VAO"===a.activeTab?t("HoaDonMuaVao",{attrs:{"popup-ref":a.popupRef}}):a._e(),"TAB_HOA_DON_BAN_RA"===a.activeTab?t("HoaDonBanRa",{attrs:{"popup-ref":a.popupRef}}):a._e()],1),t("div",{staticClass:"grp-control"},[t("div",{staticClass:"grp-control-tab"},[a.isHachToan?t("span",{class:{"active-tab":"TAB_HACH_TOAN"===a.activeTab},on:{click:function(n){a.activeTab="TAB_HACH_TOAN"}}},[a._v("Hạch toán")]):a._e(),a.isNhapVatTu?t("span",{class:{"active-tab":"TAB_NHAP_VAT_TU"===a.activeTab},on:{click:function(n){a.activeTab="TAB_NHAP_VAT_TU"}}},[a._v("Nhập vật tư")]):a._e(),a.isXuatVatTu?t("span",{class:{"active-tab":"TAB_XUAT_VAT_TU"===a.activeTab},on:{click:function(n){a.activeTab="TAB_XUAT_VAT_TU"}}},[a._v("Xuất vật tư")]):a._e(),a.isHoaDonMuaVao?t("span",{class:{"active-tab":"TAB_HOA_DON_MUA_VAO"===a.activeTab},on:{click:function(n){a.activeTab="TAB_HOA_DON_MUA_VAO"}}},[a._v("Hóa đơn mua vào")]):a._e(),a.isHoaDonBanRa?t("span",{class:{"active-tab":"TAB_HOA_DON_BAN_RA"===a.activeTab},on:{click:function(n){a.activeTab="TAB_HOA_DON_BAN_RA"}}},[a._v("Hóa đơn bán ra")]):a._e()]),t("div",{staticClass:"grp-control-button"},[t("span",{staticStyle:{color:"green","font-weight":"bold"}},[a._v("hdr_id: "+a._s(a.nhatKyChung.chungTu.hdr_id))]),t("el-divider",{attrs:{direction:"vertical"}}),t("el-button",{attrs:{type:"info"}},[a._v("In chứng từ")]),t("el-button",{attrs:{type:"success"},on:{click:a.sendData}},[a._v("Ghi")]),t("el-button",{attrs:{type:"success",disabled:!a.nhatKyChung.chungTu||!a.nhatKyChung.chungTu.hdr_id},on:{click:a.initData}},[a._v("Thêm mới chứng từ")])],1)]),t("TablePopup",{ref:"popupRef"})],1)},o=[],i=t("5530"),h=(t("b0c0"),function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticClass:"container"},[t("div",{staticClass:"panel-wrapper"},[t("div",{staticClass:"panel-label"},[a._v("Thông tin chứng từ")]),t("div",{staticClass:"left-panel"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("floating-input",{attrs:{disabled:"",label:"STT GS"},model:{value:a.nhatKyChung.chungTu.sttgs,callback:function(n){a.$set(a.nhatKyChung.chungTu,"sttgs",n)},expression:"nhatKyChung.chungTu.sttgs"}})],1),t("el-col",{attrs:{span:12}},[t("floating-input",{attrs:{disabled:"",label:"Ký hiệu - Số CT"},model:{value:a.nhatKyChung.chungTu.kyHieuSoCT,callback:function(n){a.$set(a.nhatKyChung.chungTu,"kyHieuSoCT",n)},expression:"nhatKyChung.chungTu.kyHieuSoCT"}})],1)],1),t("el-row",{staticClass:"row-margin",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("floating-label-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",label:"Ngày",format:"dd/MM/yyyy","value-format":"dd/MM/yyyy"},model:{value:a.nhatKyChung.chungTu.ngay,callback:function(n){a.$set(a.nhatKyChung.chungTu,"ngay",n)},expression:"nhatKyChung.chungTu.ngay"}})],1),t("el-col",{staticClass:"checkbox-middle",attrs:{span:8}},[t("el-checkbox",{model:{value:a.nhatKyChung.chungTu.hienSoChungTu,callback:function(n){a.$set(a.nhatKyChung.chungTu,"hienSoChungTu",n)},expression:"nhatKyChung.chungTu.hienSoChungTu"}},[a._v("Hiện số chứng từ")])],1),t("el-col",{staticClass:"checkbox-middle",attrs:{span:8}},[t("el-checkbox",{model:{value:a.nhatKyChung.thongTinKhachHang.hachToanNgoaiTe,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"hachToanNgoaiTe",n)},expression:"nhatKyChung.thongTinKhachHang.hachToanNgoaiTe"}},[a._v("Hạch toán ngoại tệ")])],1)],1),t("el-row",{staticClass:"row-margin"},[t("el-col",{attrs:{span:24}},[t("floating-input",{attrs:{label:"Nội dung",title:a.nhatKyChung.chungTu.noiDung},model:{value:a.nhatKyChung.chungTu.noiDung,callback:function(n){a.$set(a.nhatKyChung.chungTu,"noiDung",n)},expression:"nhatKyChung.chungTu.noiDung"}})],1)],1),t("el-row",{staticClass:"row-margin",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("floating-input",{attrs:{label:"Khách hàng"},model:{value:a.nhatKyChung.chungTu.khachHang,callback:function(n){a.$set(a.nhatKyChung.chungTu,"khachHang",n)},expression:"nhatKyChung.chungTu.khachHang"}})],1),t("el-col",{staticClass:"input-button-group",attrs:{span:2}},[t("el-button",{staticClass:"align-button",attrs:{size:"mini",type:"info",icon:"el-icon-more"},on:{click:a.openPopupKhachHang}})],1),t("el-col",{attrs:{span:8}},[t("floating-input",{attrs:{label:"Nhà cung cấp"},model:{value:a.nhatKyChung.thongTinKhachHang.nhaCungCap,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"nhaCungCap",n)},expression:"nhatKyChung.thongTinKhachHang.nhaCungCap"}})],1),t("el-col",{staticClass:"input-button-group",attrs:{span:2}},[t("el-button",{staticClass:"align-button",attrs:{size:"mini",type:"info",icon:"el-icon-more"},on:{click:a.openPopupNhaCungCap}})],1)],1)],1)]),t("div",{staticClass:"panel-wrapper"},[t("div",{staticClass:"panel-label"},[a._v("Thông tin khách hàng")]),t("div",{staticClass:"right-panel"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:6}},[t("floating-input",{attrs:{label:"Mã số thuế"},model:{value:a.nhatKyChung.thongTinKhachHang.maSoThue,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"maSoThue",n)},expression:"nhatKyChung.thongTinKhachHang.maSoThue"}})],1),t("el-col",{staticClass:"input-button-group",attrs:{span:2}},[t("el-button",{staticClass:"align-button",attrs:{type:"primary",icon:"el-icon-check"},on:{click:a.checkMst}})],1),t("el-col",{attrs:{span:16}},[t("floating-input",{attrs:{label:"Tên đơn vị",title:a.nhatKyChung.thongTinKhachHang.tenDonVi},model:{value:a.nhatKyChung.thongTinKhachHang.tenDonVi,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"tenDonVi",n)},expression:"nhatKyChung.thongTinKhachHang.tenDonVi"}})],1)],1),t("el-row",{staticClass:"row-margin",attrs:{gutter:10}},[t("el-col",{attrs:{span:14}},[t("floating-input",{attrs:{label:"Địa chỉ",title:a.nhatKyChung.thongTinKhachHang.diaChi},model:{value:a.nhatKyChung.thongTinKhachHang.diaChi,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"diaChi",n)},expression:"nhatKyChung.thongTinKhachHang.diaChi"}})],1),t("el-col",{attrs:{span:10}},[t("floating-input",{attrs:{label:"Số điện thoại"},model:{value:a.nhatKyChung.thongTinKhachHang.dienThoai,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"dienThoai",n)},expression:"nhatKyChung.thongTinKhachHang.dienThoai"}})],1)],1),t("el-row",{staticClass:"row-margin",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("floating-input",{attrs:{label:"Số tài khoản"},model:{value:a.nhatKyChung.thongTinKhachHang.soTaiKhoan,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"soTaiKhoan",n)},expression:"nhatKyChung.thongTinKhachHang.soTaiKhoan"}})],1),t("el-col",{staticClass:"input-button-group",attrs:{span:2}},[t("el-button",{staticClass:"align-button",attrs:{size:"mini",type:"info",icon:"el-icon-more"},on:{click:a.openPopupTaiKhoanNganHang}})],1),t("el-col",{attrs:{span:14}},[t("floating-input",{attrs:{label:"Ngân hàng",title:a.nhatKyChung.thongTinKhachHang.nganHang},model:{value:a.nhatKyChung.thongTinKhachHang.nganHang,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"nganHang",n)},expression:"nhatKyChung.thongTinKhachHang.nganHang"}})],1)],1),t("el-row",{staticClass:"row-margin",attrs:{gutter:10}},[t("el-col",{attrs:{span:10}},[t("floating-label-select",{attrs:{placeholder:"Chọn",label:"Hình thức thanh toán"},model:{value:a.nhatKyChung.thongTinKhachHang.hinhThucTT,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"hinhThucTT",n)},expression:"nhatKyChung.thongTinKhachHang.hinhThucTT"}},[t("el-option",{attrs:{label:"Tiền mặt",value:"tienmat"}}),t("el-option",{attrs:{label:"Chuyển khoản",value:"ck"}})],1)],1),t("el-col",{attrs:{span:10}},[t("floating-input",{attrs:{label:"Người giao dịch",title:a.nhatKyChung.thongTinKhachHang.tenNguoiGiaoDich},model:{value:a.nhatKyChung.thongTinKhachHang.tenNguoiGiaoDich,callback:function(n){a.$set(a.nhatKyChung.thongTinKhachHang,"tenNguoiGiaoDich",n)},expression:"nhatKyChung.thongTinKhachHang.tenNguoiGiaoDich"}})],1),t("el-col",{staticClass:"input-button-group",attrs:{span:2}},[t("el-button",{staticClass:"align-button",attrs:{size:"mini",type:"info",icon:"el-icon-more"},on:{click:a.openPopupNguoiGiaoDich}})],1)],1)],1)])])}),l=[],u=t("c14f"),p=t("1da1"),c=(t("7db0"),t("d3b7"),t("498a"),t("0643"),t("fffc"),t("95e5")),r=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticClass:"floating-label-select",class:{"is-focused":a.isFocused||a.hasValue,"is-disabled":a.disabled}},[t("el-select",a._b({staticStyle:{width:"100%"},attrs:{placeholder:a.placeholder,disabled:a.disabled,clearable:a.clearable,filterable:a.filterable,multiple:a.multiple},on:{focus:a.handleFocus,blur:a.handleBlur,change:a.handleChange},model:{value:a.selectValue,callback:function(n){a.selectValue=n},expression:"selectValue"}},"el-select",a.$attrs,!1),[a._t("default")],2),t("label",[a._v(a._s(a.label))])],1)},s=[],g=(t("a9e3"),{name:"FloatingLabelSelect",props:{value:[String,Number,Array],label:String,placeholder:{type:String,default:" "},disabled:Boolean,clearable:Boolean,filterable:Boolean,multiple:Boolean},data:function(){return{isFocused:!1}},computed:{selectValue:{get:function(){return this.value},set:function(a){this.$emit("input",a)}},hasValue:function(){return this.multiple&&Array.isArray(this.value)?this.value.length>0:!!this.value}},methods:{handleFocus:function(a){this.isFocused=!0,this.$emit("focus",a)},handleBlur:function(a){this.isFocused=!1,this.$emit("blur",a)},handleChange:function(a){this.$emit("change",a)}}}),d=g,T=(t("105a"),t("2877")),m=Object(T["a"])(d,r,s,!1,null,"27876fe8",null),b=m.exports,f=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticClass:"floating-label-wrapper",class:{focused:a.focused,filled:a.filled}},[t("label",[a._v(a._s(a.label))]),t("el-date-picker",a._g(a._b({staticClass:"floating-date-picker",on:{focus:function(n){a.focused=!0},blur:function(n){a.focused=!1}},model:{value:a.innerValue,callback:function(n){a.innerValue=n},expression:"innerValue"}},"el-date-picker",a.$attrs,!1),a.$listeners))],1)},C=[],w={name:"FloatingLabelDatePicker",props:{value:[String,Date],label:String},data:function(){return{focused:!1,innerValue:this.value}},computed:{filled:function(){return!!this.innerValue}},watch:{innerValue:function(a){this.$emit("input",a)},value:function(a){this.innerValue=a}}},v=w,H=(t("4e36"),Object(T["a"])(v,f,C,!1,null,"8ab50ed0",null)),x=H.exports,_=t("2f62"),y={name:"NhatKyChung",components:{FloatingInput:c["a"],FloatingLabelSelect:b,FloatingLabelDatePicker:x},props:["popupRef"],data:function(){return{columnKhachHangPopupTable:[{prop:"id",label:"ID",width:"120px"},{prop:"cap",label:"Cấp",width:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",width:"100px"},{prop:"ten_congty",label:"Tên đơn vị",width:"250px"},{prop:"du_no",label:"Dư nợ",width:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",width:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",width:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",width:"150px"},{prop:"tinh",label:"Tỉnh",width:"150px"},{prop:"dien_thoai",label:"Điện thoại",width:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",width:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",width:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",width:"150px"},{prop:"khach_hang",label:"Khách hàng",width:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",width:"180px"},{prop:"tai_khoan",label:"Tài khoản",width:"120px"},{prop:"ngan_hang",label:"Ngân hàng",width:"200px"},{prop:"email",label:"Địa chỉ Email",width:"200px"}],columnNhaCungCapPopupTable:[{prop:"id",label:"ID",minWidth:"120px"},{prop:"cap",label:"Cấp",minWidth:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",minWidth:"100px"},{prop:"ten_congty",label:"Tên đơn vị",minWidth:"200px",maxWidth:"250px",wrapText:!0},{prop:"du_no",label:"Dư nợ",minWidth:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",minWidth:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",minWidth:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",minWidth:"150px"},{prop:"tinh",label:"Tỉnh",minWidth:"150px"},{prop:"dien_thoai",label:"Điện thoại",minWidth:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",minWidth:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",minWidth:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",minWidth:"150px"},{prop:"khach_hang",label:"Khách hàng",minWidth:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",minWidth:"180px"},{prop:"tai_khoan",label:"Tài khoản",minWidth:"120px"},{prop:"ngan_hang",label:"Ngân hàng",minWidth:"200px"},{prop:"email",label:"Địa chỉ Email",minWidth:"200px"}],columnNguoiGiaoDichPopupTable:[{prop:"ma_nguoi_gd",label:"Mã người giao dịch",width:"100px"},{prop:"ten_nguoi_gd",label:"Tên người giao dịch",width:"180px"}],columnTaiKhoanNganHangPopupTable:[{prop:"mst",label:"Mã số thuế"},{prop:"so_tk_nh",label:"Số tài khoản"},{prop:"ten_nh",label:"Tên ngân hàng"}]}},computed:Object(i["a"])({},Object(_["d"])("nhapchungtu",["nhatKyChung","lstHinhThucTT","lstKhachHang","lstNhaCungCap","lstNguoiGiaoDich","lstTaiKhoanNganHang"])),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["updateMultipleNhatKyChung","loadTaiKhoanNganHang","loadNguoiGiaoDich"])),{},{handleSelect:function(a){console.log(a)},checkMst:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t,e,o,i;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(e=((null===(t=a.nhatKyChung)||void 0===t||null===(t=t.thongTinKhachHang)||void 0===t?void 0:t.maSoThue)||"").trim(),e){n.n=1;break}return a.$message.warning("Vui lòng nhập mã số thuế cần kiểm tra."),n.a(2);case 1:if(o=a.lstKhachHang.find((function(a){return a.mst_kh_ncc===e})),!o){n.n=2;break}return a.$message.success("Tìm thấy trong danh sách khách hàng."),console.log("Thông tin khách hàng:",o),a.updateMultipleNhatKyChung([{path:"chungTu.khachHang",value:o.id},{path:"thongTinKhachHang.tenDonVi",value:o.ten_congty},{path:"thongTinKhachHang.diaChi",value:o.dia_chi},{path:"thongTinKhachHang.dienThoai",value:o.dien_thoai},{path:"thongTinKhachHang.email",value:o.email}]),a.loadTaiKhoanNganHang(e),a.loadNguoiGiaoDich(e),n.a(2);case 2:if(i=a.lstNhaCungCap.find((function(a){return a.mst_kh_ncc===e})),!i){n.n=3;break}return a.$message.success("Tìm thấy trong danh sách nhà cung cấp."),console.log("Thông tin nhà cung cấp:",i),a.updateMultipleNhatKyChung([{path:"thongTinKhachHang.nhaCungCap",value:i.id},{path:"thongTinKhachHang.tenDonVi",value:i.ten_congty},{path:"thongTinKhachHang.diaChi",value:i.dia_chi},{path:"thongTinKhachHang.dienThoai",value:i.dien_thoai},{path:"thongTinKhachHang.email",value:i.email}]),n.a(2);case 3:a.$message.error("Không tìm thấy mã số thuế trong danh sách khách hàng hoặc nhà cung cấp.");case 4:return n.a(2)}}),n)})))()},openPopupKhachHang:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC KHÁCH HÀNG",width:"90%",columns:a.columnKhachHangPopupTable,data:a.lstKhachHang});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"chungTu.khachHang",value:t.id},{path:"thongTinKhachHang.maSoThue",value:t.mst_kh_ncc},{path:"thongTinKhachHang.tenDonVi",value:t.ten_congty},{path:"thongTinKhachHang.diaChi",value:t.dia_chi},{path:"thongTinKhachHang.dienThoai",value:t.dien_thoai},{path:"thongTinKhachHang.email",value:t.email}]),a.loadTaiKhoanNganHang(t.mst_kh_ncc),a.loadNguoiGiaoDich(t.mst_kh_ncc));case 2:return n.a(2)}}),n)})))()},openPopupNhaCungCap:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC NHÀ CUNG CẤP",width:"90%",columns:a.columnNhaCungCapPopupTable,data:a.lstNhaCungCap});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"thongTinKhachHang.nhaCungCap",value:t.id},{path:"thongTinKhachHang.maSoThue",value:t.mst_kh_ncc},{path:"thongTinKhachHang.tenDonVi",value:t.ten_congty},{path:"thongTinKhachHang.diaChi",value:t.dia_chi},{path:"thongTinKhachHang.dienThoai",value:t.dien_thoai},{path:"thongTinKhachHang.email",value:t.email}]));case 2:return n.a(2)}}),n)})))()},openPopupNguoiGiaoDich:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC NGƯỜI GIAO DỊCH",width:"50%",columns:a.columnNguoiGiaoDichPopupTable,data:a.lstNguoiGiaoDich});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"thongTinKhachHang.maNguoiGiaoDich",value:t.ma_nguoi_gd},{path:"thongTinKhachHang.tenNguoiGiaoDich",value:t.ten_nguoi_gd}]));case 2:return n.a(2)}}),n)})))()},openPopupTaiKhoanNganHang:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN NGÂN HÀNG",width:"50%",columns:a.columnTaiKhoanNganHangPopupTable,data:a.lstTaiKhoanNganHang});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"thongTinKhachHang.soTaiKhoan",value:t.so_tk_nh},{path:"thongTinKhachHang.nganHang",value:t.ten_nh}]));case 2:return n.a(2)}}),n)})))()}})},K=y,k=(t("bcb5"),Object(T["a"])(K,h,l,!1,null,"984e6f98",null)),N=k.exports,V=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticStyle:{height:"100%"}},[t("TableData",{attrs:{columns:a.columns,data:a.hachToanData},on:{"space-key-pressed":a.handlePressSpaceKey,"handle-row":a.handleRow,"change-value":a.handleChangeValue}})],1)},D=[],W=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticClass:"table-container"},[t("el-table",{ref:"table",staticClass:"custom-table",attrs:{data:a.filteredData,border:"","header-cell-style":{textAlign:"center"},"row-class-name":a.tableRowClass}},[a._l(a.visibleColumns,(function(n){return t("el-table-column",{key:n.prop,attrs:{prop:n.prop,label:n.label,"min-width":n.minWidth?n.minWidth+"px":void 0,align:n.align},scopedSlots:a._u([{key:"default",fn:function(e){return["inserting"===e.row.editType||"updating"===e.row.editType||"saving"===e.row.editType?t("div",["combobox"===n.type?t("el-select",{ref:"select_"+e.$index+"_"+n.prop,refInFor:!0,attrs:{placeholder:"Chọn",filterable:"",clearable:""},on:{change:function(t){return a.handleComboboxChange(e.row,n,t)}},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}},a._l(n.combodata,(function(a){return t("el-option",{key:a.code,attrs:{label:a.name,value:a.code}})})),1):"boolean"===n.type?t("el-checkbox",{on:{change:function(t){return a.handleCheckboxChange(e.row,n,t)}},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}}):"date"===n.format?t("el-date-picker",{ref:"datepicker_"+e.$index+"_"+n.prop,refInFor:!0,staticStyle:{width:"100% !important","max-width":"100% !important"},attrs:{type:"date",placeholder:"Chọn ngày",format:"dd/MM/yyyy","value-format":"dd/MM/yyyy",disabled:n.disableEditing},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}}):"currency"===n.format?t("el-input",{ref:"input_"+e.$index+"_"+n.prop,refInFor:!0,attrs:{disabled:n.disableEditing},on:{change:function(t){a.handleValidation(e.row,n,t)&&n.onChangeValue&&a.handleChangeValue(e.row,n)}},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&a._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.preventDefault(),n.onSpaceKey&&a.handleSpaceKey(e.row,n)}},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}}):t("el-input",{ref:"input_"+e.$index+"_"+n.prop,refInFor:!0,class:{"error-input":e.row.errors&&e.row.errors[n.prop]},attrs:{disabled:n.disableEditing},on:{change:function(t){a.handleValidation(e.row,n,t)&&n.onChangeValue&&a.handleChangeValue(e.row,n)},blur:function(t){n.onLostForcus&&a.handleBlur(e.row,n)}},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&a._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.preventDefault(),n.onSpaceKey&&a.handleSpaceKey(e.row,n)}},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}})],1):t("div",{class:{"wrap-text":n.wrapText}},["combobox"===n.type?t("span",[a._v(" "+a._s(a.getComboLabel(n.combodata,e.row[n.prop]))+" ")]):"boolean"===n.type?t("el-checkbox",{attrs:{disabled:""},model:{value:e.row[n.prop],callback:function(t){a.$set(e.row,n.prop,t)},expression:"scope.row[col.prop]"}}):[a._v(" "+a._s("currency"===n.format?a.formatDisplayCurrency(e.row[n.prop]):"date"===n.format?a.formatDateDisplay(e.row[n.prop]):e.row[n.prop])+" ")]],2)]}}],null,!0)})})),t("el-table-column",{attrs:{label:"Action","min-width":"200",fixed:"right",align:"center"},scopedSlots:a._u([{key:"default",fn:function(n){return["inserting"!==n.row.editType&&"updating"!==n.row.editType&&"deleting"!==n.row.editType&&"saving"!==n.row.editType?[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return a.editRow(n.row)}}},[a._v("Sửa")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return a.deleteRow(n.row)}}},[a._v("Xóa")])]:[t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return a.saveRow(n.row)}}},[a._v("Lưu")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return a.cancel(n.row)}}},[a._v("Hủy")])]]}}])})],2),t("div",{staticClass:"button-container"},[t("el-button",{staticClass:"add-button",attrs:{size:"mini",type:"primary"},on:{click:a.addRow}},[a._v("Thêm dòng")])],1)],1)},O=[],S=t("2909"),R=(t("99af"),t("4de4"),t("d81d"),t("13d5"),t("fb6a"),t("4d63"),t("ac1f"),t("2c3e"),t("00b4"),t("25f0"),t("2382"),t("a573"),t("9d4a"),{props:{columns:{type:Array,required:!0},data:{type:Array,required:!0}},computed:{filteredData:function(){return this.data.filter((function(a){return"deleted"!==a.editType}))},visibleColumns:function(){return this.columns.filter((function(a){return!a.hidden}))}},methods:{getComboLabel:function(a,n){var t=null===a||void 0===a?void 0:a.find((function(a){return a.code===n}));return t?t.name:""},editRow:function(a){this.$emit("handle-row","updating",a)},deleteRow:function(a){this.$emit("handle-row","deleting",a)},saveRow:function(a){this.$emit("handle-row","saving",a)},cancel:function(a){this.$emit("handle-row","canceling",a)},addRow:function(){var a=this.columns.find((function(a){return a.identity})),n=this.createEmptyRow(this.columns);if(n=Object(i["a"])(Object(i["a"])({},n),{},{editType:"inserting",originalData:{}}),a){var t=a.prop,e=Math.max.apply(Math,[0].concat(Object(S["a"])(this.data.map((function(a){return a[t]||0})))));n[t]=e+1}this.$emit("handle-row","inserting",n)},formatDisplayCurrency:function(a){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a||0)},handleSpaceKey:function(a,n){this.$emit("space-key-pressed",{row:a,col:n})},handleChangeValue:function(a,n){this.$emit("change-value",{row:a,col:n})},handleCheckboxChange:function(a,n,t){this.$emit("change-value",{row:a,col:n,value:t})},handleComboboxChange:function(a,n,t){this.$emit("change-value",{row:a,col:n,value:t})},handleBlur:function(a,n){this.$emit("cell-blur",{row:a,col:n,value:a[n.prop]})},validateAndFormatDate:function(a,n){var t=a[n];if(/^\d{6,8}$/.test(t)){var e=t.slice(0,2),o=t.slice(2,4),i=6===t.length?"20"+t.slice(4,6):t.slice(4,8),h="".concat(i,"-").concat(o,"-").concat(e),l=new Date(h);isNaN(l.getTime())?(alert("Ngày nhập không hợp lệ"),a[n]=""):a[n]="".concat(e,"/").concat(o,"/").concat(i)}},formatDateDisplay:function(a){if(!a)return"";var n=a.split("/");return 3===n.length?"".concat(n[0],"/").concat(n[1],"/").concat(n[2]):a},tableRowClass:function(a){var n=a.row;return"deleting"===n.editType?"row-deleting":""},createEmptyRow:function(a){return a.reduce((function(a,n){return a[n.prop]=void 0!==n.defaultValue?"function"===typeof n.defaultValue?n.defaultValue():n.defaultValue:null,a}),{})},handleValidation:function(a,n,t){var e=this.validateInput(a[n.prop],n);return e?(this.$message.error(e),a.errors||this.$set(a,"errors",{}),this.$set(a.errors,n.prop,!0),this.$nextTick((function(){t.target.focus(),t.target.select()})),!1):(a.errors&&this.$set(a.errors,n.prop,!1),!0)},validateInput:function(a,n){if(!a)return"";var t="";return n.regexPattern&&!new RegExp(n.regexPattern).test(a)&&(t=n.errorMessage||"Giá trị nhập vào không hợp lệ!"),n.maxLength&&a.length>n.maxLength&&(t="Không được nhập quá ".concat(n.maxLength," ký tự!")),t},focusCell:function(a,n){var t=this;this.$nextTick((function(){var e=t.filteredData.indexOf(a);if(-1!==e){var o=t.$refs["input_".concat(e,"_").concat(n)];if(o&&o.length>0){var i=o[0];i.focus&&i.focus(),i.select&&t.$nextTick((function(){return i.select()}))}else console.warn("Không tìm thấy input ref: input_".concat(e,"_").concat(n))}}))},focusDatePicker:function(a,n){var t=this;this.$nextTick((function(){var e=t.filteredData.indexOf(a),o=t.$refs["datepicker_".concat(e,"_").concat(n)];o&&o.length>0&&o[0].focus()}))}}}),M=R,P=(t("e737"),Object(T["a"])(M,W,O,!1,null,"086020da",null)),j=P.exports,B={components:{TableData:j},props:["popupRef"],data:function(){return{columnTaiKhoanPopupTable:[{prop:"sohieutk",label:"Số hiệu tài khoản"},{prop:"ten_tk",label:"Tên tài khoản"}],columnTaiKhoanChiTietPopupTable:[{prop:"ma_chitiet",label:"Mã chi tiết"},{prop:"ten_chitiet",label:"Tên chi tiết"}],columnVatTuPopupTable:[{prop:"ma_nhom",label:"Mã nhóm hàng"},{prop:"ma_vattu",label:"Mã vật tư"},{prop:"ten_vattu",label:"Tên vật tư"}],columnCanBo141PopupTable:[{prop:"sohieutk",label:"Số hiệu TK"},{prop:"ma_kho",label:"Mã Kho"},{prop:"ma_nhom",label:"Mã Nhóm"},{prop:"ma_vattu",label:"Mã cán bộ"},{prop:"ten_vattu",label:"Tên cán bộ"},{prop:"chuc_vu",label:"Chức vụ"},{prop:"heso_phucap",label:"Hệ số phụ cấp"},{prop:"heso_luong",label:"Hệ số lương"}],columnKhachHangPopupTable:[{prop:"id",label:"ID",width:"120px"},{prop:"cap",label:"Cấp",width:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",width:"100px"},{prop:"ten_congty",label:"Tên đơn vị",width:"250px"},{prop:"du_no",label:"Dư nợ",width:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",width:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",width:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",width:"150px"},{prop:"tinh",label:"Tỉnh",width:"150px"},{prop:"dien_thoai",label:"Điện thoại",width:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",width:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",width:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",width:"150px"},{prop:"khach_hang",label:"Khách hàng",width:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",width:"180px"},{prop:"tai_khoan",label:"Tài khoản",width:"120px"},{prop:"ngan_hang",label:"Ngân hàng",width:"200px"},{prop:"email",label:"Địa chỉ Email",width:"200px"}],columnNhaCungCapPopupTable:[{prop:"id",label:"ID",minWidth:"120px"},{prop:"cap",label:"Cấp",minWidth:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",minWidth:"100px"},{prop:"ten_congty",label:"Tên đơn vị",minWidth:"200px",maxWidth:"250px",wrapText:!0},{prop:"du_no",label:"Dư nợ",minWidth:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",minWidth:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",minWidth:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",minWidth:"150px"},{prop:"tinh",label:"Tỉnh",minWidth:"150px"},{prop:"dien_thoai",label:"Điện thoại",minWidth:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",minWidth:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",minWidth:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",minWidth:"150px"},{prop:"khach_hang",label:"Khách hàng",minWidth:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",minWidth:"180px"},{prop:"tai_khoan",label:"Tài khoản",minWidth:"120px"},{prop:"ngan_hang",label:"Ngân hàng",minWidth:"200px"},{prop:"email",label:"Địa chỉ Email",minWidth:"200px"}],columns:[{prop:"dongChungTu",label:"Dòng chứng từ",minWidth:"120px",align:"center",disableEditing:!0,identity:!0},{prop:"tkNo",label:"TK Nợ",minWidth:"80px",align:"center",onSpaceKey:!0,regexPattern:"^[0-9]*$",maxLength:10,errorMessage:"Chỉ được nhập số!"},{prop:"chiTietNo",label:"Chi tiết nợ",minWidth:"150px",align:"center",regexPattern:"^[0-9]*$",maxLength:15,errorMessage:"Chỉ được nhập số!"},{prop:"tkCo",label:"TK Có",minWidth:"80px",align:"center",onSpaceKey:!0,regexPattern:"^[0-9]*$",maxLength:10,errorMessage:"Chỉ được nhập số!"},{prop:"chiTietCo",label:"Chi tiết có",minWidth:"150px",align:"center",regexPattern:"^[0-9]*$",maxLength:15,errorMessage:"Chỉ được nhập số!"},{prop:"soTien",label:"Số tiền",minWidth:"180px",align:"right",format:"currency",regexPattern:"^[0-9]*$",maxLength:20,errorMessage:"Chỉ được nhập số!"},{prop:"thoiHanThanhToan",label:"Thời hạn thanh toán",minWidth:"150px",align:"right",format:"date"},{prop:"thoiHanChietKhau",label:"Thời hạn chiết khấu",minWidth:"150px",align:"right",format:"date"},{prop:"kyHieuSoHoaDon",label:"Ký hiệu số Hóa đơn",minWidth:"150px",regexPattern:"^[a-zA-Z0-9-_]+$",maxLength:20,errorMessage:"Chỉ nhập chữ, số, dấu - hoặc _!"}]}},computed:Object(i["a"])({},Object(_["d"])("nhapchungtu",["nhatKyChung","hachToanData","lstTaiKhoan","lstTaiKhoanChiTiet","lstKhachHang","lstCanBo141","lstNhaCungCap","lstVatTu"])),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["setRowFlag","updateHachToanCell","updateMultipleNhatKyChung","loadTaiKhoanChiTiet"])),{},{handleRow:function(a,n){console.log("handle",a,n),this.setRowFlag({stateName:"hachToanData",key:"dongChungTu",value:n.dongChungTu,flagName:a,row:n})},handlePressSpaceKey:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){var e,o,i,h,l,p,c;return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:if("tkNo"!==a.col.prop&&"tkCo"!==a.col.prop){t.n=19;break}if(!n.popupRef){t.n=19;break}if("131"!==a.row[a.col.prop]){t.n=2;break}if(n.nhatKyChung.chungTu.khachHang){t.n=1;break}return t.n=1,n.openPopupKhachHang();case 1:n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:n.nhatKyChung.chungTu.khachHang}),t.n=19;break;case 2:if("331"!==a.row[a.col.prop]){t.n=4;break}if(n.nhatKyChung.thongTinKhachHang.nhaCungCap){t.n=3;break}return t.n=3,n.openPopupNhaCungCap();case 3:n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:n.nhatKyChung.thongTinKhachHang.nhaCungCap}),t.n=19;break;case 4:if("141"!==a.row[a.col.prop]&&"334"!==a.row[a.col.prop]){t.n=6;break}return t.n=5,n.popupRef.openPopup({title:"DANH MỤC CÁN BỘ",width:"50%",columns:n.columnCanBo141PopupTable,data:n.lstCanBo141});case 5:e=t.v,e&&n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:e.ma_vattu}),t.n=19;break;case 6:if("154"!==a.row[a.col.prop]){t.n=8;break}return t.n=7,n.popupRef.openPopup({title:"DANH MỤC VẬT TƯ",width:"50%",columns:n.columnVatTuPopupTable,data:n.lstVatTu});case 7:o=t.v,o&&n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:a.col.prop,value:o.ma_vattu}),t.n=19;break;case 8:if(i=a.row[a.col.prop],h=n.lstTaiKhoan.find((function(a){return a.sohieutk===i})),!h){t.n=13;break}if(!h.co_chitiet){t.n=11;break}return console.log("co chi tiet "),t.n=9,n.loadTaiKhoanChiTiet(h.sohieutk);case 9:return t.n=10,n.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN CHI TIẾT",width:"50%",columns:n.columnTaiKhoanChiTietPopupTable,data:n.lstTaiKhoanChiTiet});case 10:l=t.v,l&&n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:l.ma_chitiet}),t.n=12;break;case 11:n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:""});case 12:t.n=19;break;case 13:return console.log("xxxxxxxxxx"),t.n=14,n.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN",width:"50%",columns:n.columnTaiKhoanPopupTable,data:n.lstTaiKhoan});case 14:if(p=t.v,!p){t.n=19;break}return t.n=15,n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:a.col.prop,value:p.sohieutk});case 15:if(!p.co_chitiet){t.n=18;break}return t.n=16,n.loadTaiKhoanChiTiet(p.sohieutk);case 16:return t.n=17,n.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN CHI TIẾT",width:"50%",columns:n.columnTaiKhoanChiTietPopupTable,data:n.lstTaiKhoanChiTiet});case 17:c=t.v,c&&n.updateHachToanCell({dongChungTu:a.row.dongChungTu,column:"tkNo"===a.col.prop?"chiTietNo":"chiTietCo",value:c.ma_chitiet}),t.n=19;break;case 18:console.log("cap_chitet ≠ 0 hoặc result không tồn tại");case 19:return t.a(2)}}),t)})))()},handleChangeValue:function(a){return Object(p["a"])(Object(u["a"])().m((function a(){return Object(u["a"])().w((function(a){while(1)switch(a.n){case 0:case 1:return a.a(2)}}),a)})))()},openPopupKhachHang:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC KHÁCH HÀNG",width:"90%",columns:a.columnKhachHangPopupTable,data:a.lstKhachHang});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"chungTu.khachHang",value:t.id},{path:"thongTinKhachHang.maSoThue",value:t.mst_kh_ncc},{path:"thongTinKhachHang.tenDonVi",value:t.ten_congty},{path:"thongTinKhachHang.diaChi",value:t.dia_chi},{path:"thongTinKhachHang.dienThoai",value:t.dien_thoai},{path:"thongTinKhachHang.email",value:t.email}]));case 2:return n.a(2)}}),n)})))()},openPopupNhaCungCap:function(){var a=this;return Object(p["a"])(Object(u["a"])().m((function n(){var t;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:if(!a.popupRef){n.n=2;break}return n.n=1,a.popupRef.openPopup({title:"DANH MỤC NHÀ CUNG CẤP",width:"90%",columns:a.columnNhaCungCapPopupTable,data:a.lstNhaCungCap});case 1:t=n.v,t&&(console.log(t),a.updateMultipleNhatKyChung([{path:"thongTinKhachHang.nhaCungCap",value:t.id},{path:"thongTinKhachHang.maSoThue",value:t.mst_kh_ncc},{path:"thongTinKhachHang.tenDonVi",value:t.ten_congty},{path:"thongTinKhachHang.diaChi",value:t.dia_chi},{path:"thongTinKhachHang.dienThoai",value:t.dien_thoai},{path:"thongTinKhachHang.email",value:t.email}]));case 2:return n.a(2)}}),n)})))()}})},A=B,$=Object(T["a"])(A,V,D,!1,null,null,null),L=$.exports,G=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",[t("TableData",{ref:"table",attrs:{columns:a.columns,data:a.nhapVatTuData},on:{"space-key-pressed":a.handlePressSpaceKey,"handle-row":a.handleRow,"change-value":a.handleChangeValue}})],1)},F=[],X={components:{TableData:j},props:["popupRef"],data:function(){return{columnTaiKhoanPopupTable:[{prop:"sohieutk",label:"Số hiệu tài khoản"},{prop:"ten_tk",label:"Tên tài khoản"}],columnKhoHangPopupTable:[{prop:"ma_kho",label:"Mã kho hàng"},{prop:"ten_kho",label:"Tên kho hàng"}],columnNhomHangPopupTable:[{prop:"ma_kho",label:"Mã kho hàng"},{prop:"ma_nhom",label:"Mã nhóm hàng"},{prop:"ten_nhom",label:"Tên nhóm hàng"}],columnVatTuPopupTable:[{prop:"ma_nhom",label:"Mã nhóm hàng",width:"100px"},{prop:"ma_vattu",label:"Mã vật tư",width:"180px"},{prop:"ten_vattu",label:"tên vật tư",width:"180px"},{prop:"dvt",label:"ĐVT",width:"180px"},{prop:"he_so_quy_doi",label:"H.Số quy đổi",width:"180px"},{prop:"ma_don_vi_quy_doi",label:"ĐVT quy đổi",width:"180px"},{prop:"vi_tri_luu_tru",label:"Vị trí lưu trữ",width:"180px"},{prop:"nam",label:"Năm",width:"180px"}],columns:[{prop:"id",label:"ID",minWidth:"110px",hidden:!0},{prop:"tkNhap",label:"TK xuất",minWidth:"80px",onSpaceKey:!0},{prop:"maKhoNhap",label:"Mã kho nhập",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"maNhom",label:"Mã nhóm",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"maVatTu",label:"Mã vật tư",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"tenVatTu",label:"Tên Vật tư",minWidth:"250px",align:"left",onSpaceKey:!0},{prop:"dvt",label:"ĐVT",minWidth:"80px",align:"center"},{prop:"soLuong",label:"Số lượng",minWidth:"120px",align:"right",format:"currency",onChangeValue:!0,regexPattern:"^[0-9]*$",maxLength:20,errorMessage:"Chỉ được nhập số!"},{prop:"soLuongTheoChungTu",label:"Số lượng theo C.Từ",minWidth:"150px",align:"right"},{prop:"donGiaBan",label:"Đơn giá Bán",minWidth:"120px",align:"right",onChangeValue:!0},{prop:"thanhTien",label:"Thành tiền",minWidth:"130px",align:"right  "},{prop:"khuyenMai",label:"Khuyến mại",minWidth:"120px",align:"center",type:"boolean"},{prop:"chietKhau",label:"Chiết khấu",minWidth:"120px",onChangeValue:!0,align:"right  "},{prop:"thanhToan",label:"Thanh toán",minWidth:"120px",align:"right  "},{prop:"thueSuat",label:"Thuế suất (%)",minWidth:"120px",onChangeValue:!0,align:"right  "},{prop:"ghiChu",label:"Ghi chú",minWidth:"180px"},{prop:"dongHachToan",label:"Dòng hoạch toán",minWidth:"130px",regexPattern:"^[0-9]*$",maxLength:15,errorMessage:"Chỉ được nhập số!"}]}},computed:Object(i["a"])({},Object(_["d"])("nhapchungtu",["popup","lstTaiKhoan","lstKhoHang","lstNhomHang","lstVatTu","nhapVatTuData"])),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["setRowFlag","updateNhapVatTuCell","updateHachToanCellV2"])),{},{handleRow:function(a,n){console.log("handle",a,n),this.setRowFlag({stateName:"nhapVatTuData",key:"dongHachToan",value:n.dongHachToan,flagName:a,row:n}),"saving"===a&&this.updateHachToanCellV2({findBy:"tkNo",findValue:n.tkNhap,column:"soTien",value:this.tinhTongThanhTienTheoTkNhap(n.tkNhap)})},popupKhoNhap:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function e(){var o;return Object(u["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.popupRef.openPopup({title:"DANH MỤC KHO HÀNG",width:"50%",columns:t.columnKhoHangPopupTable,data:t.lstKhoHang});case 1:o=e.v,o&&(t.selectedRow=o,t.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:n,value:o.ma_kho}),t.popupNhomHang(a,"maNhom"));case 2:return e.a(2)}}),e)})))()},popupNhomHang:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function e(){var o;return Object(u["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.popupRef.openPopup({title:"DANH MỤC NHÓM HÀNG",width:"50%",columns:t.columnNhomHangPopupTable,data:t.lstNhomHang.filter((function(n){return n.ma_kho===a.row.maKhoNhap}))});case 1:o=e.v,o&&(t.selectedRow=o,t.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:n,value:o.ma_nhom}),t.popupVatTu(a,"maVatTu"));case 2:return e.a(2)}}),e)})))()},popupVatTu:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function n(){var e;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:return n.n=1,t.popupRef.openPopup({title:"DANH MỤC VẬT TƯ HÀNG HÓA",width:"90%",columns:t.columnVatTuPopupTable,data:t.lstVatTu.filter((function(n){return n.ma_kho===a.row.maKhoNhap&&n.ma_nhom===a.row.maNhom}))});case 1:e=n.v,e&&(t.selectedRow=e,t.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"maVatTu",value:e.ma_vattu}),t.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"tenVatTu",value:e.ten_vattu}),t.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"dvt",value:e.dvt}),t.focusNextCell(a.row,"soLuong"));case 2:return n.a(2)}}),n)})))()},handlePressSpaceKey:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){var e;return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:if(console.log("handlePressSpaceKey - Data",a),"tkNhap"!==a.col.prop){t.n=3;break}if(!n.popupRef){t.n=2;break}return t.n=1,n.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN",width:"50%",columns:n.columnTaiKhoanPopupTable,data:n.lstTaiKhoan});case 1:e=t.v,e&&(n.selectedRow=e,n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:a.col.prop,value:e.sohieutk}));case 2:t.n=4;break;case 3:"maKhoNhap"===a.col.prop?n.popupRef&&n.popupKhoNhap(a,"maKhoNhap"):"maNhom"===a.col.prop?n.popupRef&&n.popupNhomHang(a,"maNhom"):"maVatTu"!==a.col.prop&&"tenVatTu"!==a.col.prop||n.popupRef&&n.popupVatTu(a,a.col.prop);case 4:return t.a(2)}}),t)})))()},handleChangeValue:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:"soLuong"===a.col.prop&&n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"soLuongTheoChungTu",value:a.row["soLuong"]}),"soLuong"!==a.col.prop&&"donGiaBan"!==a.col.prop||a.row["soLuong"]&&a.row["donGiaBan"]&&(n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhTien",value:a.row["soLuong"]*a.row["donGiaBan"]}),n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["soLuong"]*a.row["donGiaBan"]-a.row["chietKhau"]})),"chietKhau"===a.col.prop&&n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["thanhTien"]-a.row["chietKhau"]}),"khuyenMai"===a.col.prop&&n.updateNhapVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["khuyenMai"]?0:a.row["soLuong"]*a.row["donGiaBan"]-a.row["chietKhau"]});case 1:return t.a(2)}}),t)})))()},focusNextCell:function(a,n){var t=this;this.$nextTick((function(){var e=t.$refs.table;e&&e.focusCell&&e.focusCell(a,n),console.log("xxxx yyyy")}))},tinhTongThanhTienTheoTkNhap:function(a){return Array.isArray(this.nhapVatTuData)?this.nhapVatTuData.filter((function(n){return n.tkNhap===a})).reduce((function(a,n){var t=Number(n.thanhTien)||0;return a+t}),0):0}})},I=X,E=Object(T["a"])(I,G,F,!1,null,null,null),U=E.exports,z=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",[t("TableData",{ref:"table",attrs:{columns:a.columns,data:a.xuatVatTuData},on:{"space-key-pressed":a.handlePressSpaceKey,"handle-row":a.handleRow,"change-value":a.handleChangeValue}})],1)},q=[],Z={components:{TableData:j},props:["popupRef"],data:function(){return{columnTaiKhoanPopupTable:[{prop:"sohieutk",label:"Số hiệu tài khoản"},{prop:"ten_tk",label:"Tên tài khoản"}],columnKhoHangPopupTable:[{prop:"ma_kho",label:"Mã kho hàng"},{prop:"ten_kho",label:"Tên kho hàng"}],columnNhomHangPopupTable:[{prop:"ma_kho",label:"Mã kho hàng"},{prop:"ma_nhom",label:"Mã nhóm hàng"},{prop:"ten_nhom",label:"Tên nhóm hàng"}],columnVatTuPopupTable:[{prop:"ma_nhom",label:"Mã nhóm hàng",width:"100px"},{prop:"ma_vattu",label:"Mã vật tư",width:"180px"},{prop:"ten_vattu",label:"tên vật tư",width:"180px"},{prop:"dvt",label:"ĐVT",width:"180px"},{prop:"he_so_quy_doi",label:"H.Số quy đổi",width:"180px"},{prop:"ma_don_vi_quy_doi",label:"ĐVT quy đổi",width:"180px"},{prop:"vi_tri_luu_tru",label:"Vị trí lưu trữ",width:"180px"},{prop:"nam",label:"Năm",width:"180px"}],columns:[{prop:"id",label:"ID",minWidth:"110px",hidden:!0},{prop:"tkXuat",label:"TK xuất",minWidth:"80px",onSpaceKey:!0},{prop:"maKhoXuat",label:"Mã Kho xuất",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"maNhom",label:"Mã nhóm",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"maVatTu",label:"Mã vật tư",minWidth:"110px",align:"center",onSpaceKey:!0},{prop:"tenVatTu",label:"Tên Vật tư",minWidth:"250px",align:"left",onSpaceKey:!0},{prop:"dvt",label:"ĐVT",minWidth:"80px",align:"center"},{prop:"soLuong",label:"Số lượng",minWidth:"120px",align:"right",format:"currency",onChangeValue:!0,regexPattern:"^[0-9]*$",maxLength:20,errorMessage:"Chỉ được nhập số!"},{prop:"soLuongTheoChungTu",label:"Số lượng theo C.Từ",minWidth:"150px",align:"right"},{prop:"donGiaBan",label:"Đơn giá Bán",minWidth:"120px",align:"right",onChangeValue:!0},{prop:"thanhTien",label:"Thành tiền",minWidth:"130px",align:"right  "},{prop:"khuyenMai",label:"Khuyến mại",minWidth:"120px",align:"center",type:"boolean"},{prop:"chietKhau",label:"Chiết khấu",minWidth:"120px",onChangeValue:!0,align:"right  "},{prop:"thanhToan",label:"Thanh toán",minWidth:"120px",align:"right  "},{prop:"thueSuat",label:"Thuế suất (%)",minWidth:"120px",onChangeValue:!0,align:"right  "},{prop:"ghiChu",label:"Ghi chú",minWidth:"180px"},{prop:"dongHachToan",label:"Dòng hoạch toán",minWidth:"130px",regexPattern:"^[0-9]*$",maxLength:15,errorMessage:"Chỉ được nhập số!"}]}},computed:Object(i["a"])({},Object(_["d"])("nhapchungtu",["popup","lstTaiKhoan","lstKhoHang","lstNhomHang","lstVatTu","xuatVatTuData"])),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["setRowFlag","updateXuatVatTuCell","updateHachToanCellV2"])),{},{handleRow:function(a,n){console.log("handle",a,n),this.setRowFlag({stateName:"xuatVatTuData",key:"dongHachToan",value:n.dongHachToan,flagName:a,row:n}),"saving"===a&&this.updateHachToanCellV2({findBy:"tkCo",findValue:n.tkXuat,column:"soTien",value:this.tinhTongThanhTienTheoTkXuat(n.tkXuat)})},popupKhoXuat:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function e(){var o;return Object(u["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.popupRef.openPopup({title:"DANH MỤC KHO HÀNG",width:"50%",columns:t.columnKhoHangPopupTable,data:t.lstKhoHang});case 1:o=e.v,o&&(t.selectedRow=o,t.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:n,value:o.ma_kho}),t.popupNhomHang(a,"maNhom"));case 2:return e.a(2)}}),e)})))()},popupNhomHang:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function e(){var o;return Object(u["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.popupRef.openPopup({title:"DANH MỤC NHÓM HÀNG",width:"50%",columns:t.columnNhomHangPopupTable,data:t.lstNhomHang.filter((function(n){return n.ma_kho===a.row.maKhoXuat}))});case 1:o=e.v,o&&(t.selectedRow=o,t.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:n,value:o.ma_nhom}),t.popupVatTu(a,"maVatTu"));case 2:return e.a(2)}}),e)})))()},popupVatTu:function(a,n){var t=this;return Object(p["a"])(Object(u["a"])().m((function n(){var e;return Object(u["a"])().w((function(n){while(1)switch(n.n){case 0:return n.n=1,t.popupRef.openPopup({title:"DANH MỤC VẬT TƯ HÀNG HÓA",width:"90%",columns:t.columnVatTuPopupTable,data:t.lstVatTu.filter((function(n){return n.ma_kho===a.row.maKhoXuat&&n.ma_nhom===a.row.maNhom}))});case 1:e=n.v,e&&(t.selectedRow=e,t.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"maVatTu",value:e.ma_vattu}),t.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"tenVatTu",value:e.ten_vattu}),t.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"dvt",value:e.dvt}),t.focusNextCell(a.row,"soLuong"));case 2:return n.a(2)}}),n)})))()},handlePressSpaceKey:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){var e;return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:if(console.log("handlePressSpaceKey - Data",a),"tkXuat"!==a.col.prop){t.n=3;break}if(!n.popupRef){t.n=2;break}return t.n=1,n.popupRef.openPopup({title:"DANH MỤC TÀI KHOẢN",width:"50%",columns:n.columnTaiKhoanPopupTable,data:n.lstTaiKhoan});case 1:e=t.v,e&&(n.selectedRow=e,n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:a.col.prop,value:e.sohieutk}));case 2:t.n=4;break;case 3:"maKhoXuat"===a.col.prop?n.popupRef&&n.popupKhoXuat(a,"maKhoXuat"):"maNhom"===a.col.prop?n.popupRef&&n.popupNhomHang(a,"maNhom"):"maVatTu"!==a.col.prop&&"tenVatTu"!==a.col.prop||n.popupRef&&n.popupVatTu(a,a.col.prop);case 4:return t.a(2)}}),t)})))()},handleChangeValue:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:"soLuong"===a.col.prop&&n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"soLuongTheoChungTu",value:a.row["soLuong"]}),"soLuong"!==a.col.prop&&"donGiaBan"!==a.col.prop||a.row["soLuong"]&&a.row["donGiaBan"]&&(n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhTien",value:a.row["soLuong"]*a.row["donGiaBan"]}),n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["soLuong"]*a.row["donGiaBan"]-a.row["chietKhau"]})),"chietKhau"===a.col.prop&&n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["thanhTien"]-a.row["chietKhau"]}),"khuyenMai"===a.col.prop&&n.updateXuatVatTuCell({dongHachToan:a.row.dongHachToan,column:"thanhToan",value:a.row["khuyenMai"]?0:a.row["soLuong"]*a.row["donGiaBan"]-a.row["chietKhau"]});case 1:return t.a(2)}}),t)})))()},focusNextCell:function(a,n){var t=this;this.$nextTick((function(){var e=t.$refs.table;e&&e.focusCell&&e.focusCell(a,n),console.log("xxxx yyyy")}))},tinhTongThanhTienTheoTkXuat:function(a){return Array.isArray(this.xuatVatTuData)?this.xuatVatTuData.filter((function(n){return n.tkXuat===a})).reduce((function(a,n){var t=Number(n.thanhTien)||0;return a+t}),0):0}})},J=Z,Y=Object(T["a"])(J,z,q,!1,null,null,null),Q=Y.exports,aa=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",[t("TableData",{attrs:{columns:a.columns,data:a.hoaDonMuaVaoData},on:{"space-key-pressed":a.handlePressSpaceKey,"handle-row":a.handleRow,"change-value":a.handleChangeValue,"cell-blur":a.onCellBlur}})],1)},na=[],ta=(t("466d"),t("4d90"),t("4e3e"),t("159b"),{components:{TableData:j},props:["popupRef"],data:function(){return{columnNhaCungCapPopupTable:[{prop:"id",label:"ID",minWidth:"120px"},{prop:"cap",label:"Cấp",minWidth:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",minWidth:"100px"},{prop:"ten_congty",label:"Tên đơn vị",minWidth:"200px",maxWidth:"250px",wrapText:!0},{prop:"du_no",label:"Dư nợ",minWidth:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",minWidth:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",minWidth:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",minWidth:"150px"},{prop:"tinh",label:"Tỉnh",minWidth:"150px"},{prop:"dien_thoai",label:"Điện thoại",minWidth:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",minWidth:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",minWidth:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",minWidth:"150px"},{prop:"khach_hang",label:"Khách hàng",minWidth:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",minWidth:"180px"},{prop:"tai_khoan",label:"Tài khoản",minWidth:"120px"},{prop:"ngan_hang",label:"Ngân hàng",minWidth:"200px"},{prop:"email",label:"Địa chỉ Email",minWidth:"200px"}]}},computed:Object(i["a"])(Object(i["a"])({},Object(_["d"])("nhapchungtu",["popup","lstTaiKhoan","lstKhoHang","lstVatTu","hoaDonMuaVaoData","lstNhaCungCap","lstThueSuatMuaVao","nhatKyChung","nhapVatTuData"])),{},{comboboxDataHangHoa:function(){return this.lstThueSuatMuaVao.map((function(a){return{code:a.ma_loai,name:a.ten_loai}}))},maKhachHang:function(){return this.nhatKyChung.chungTu.khachHang},columns:function(){return[{prop:"id",label:"ID",minWidth:"100px",align:"center",disableEditing:!0,identity:!0},{prop:"tkThueDauVao",label:"TK Thuế đầu vào",minWidth:"120px",defaultValue:this.maKhachHang},{prop:"hoaDonDt",label:"Hóa đơn ĐT",minWidth:"100px",align:"center",type:"boolean",defaultValue:!0},{prop:"soHoaDon",label:"Số hóa đơn",minWidth:"120px",align:"center",onLostForcus:!0},{prop:"ngayHoaDon",label:"Ngày hóa đơn",minWidth:"150px",align:"left",format:"date"},{prop:"nguoiMuaBan",label:"Người mua/bán",minWidth:"180px",align:"left",onSpaceKey:!0},{prop:"hangHoaChiuThue",label:"Hàng hóa chịu thuế",minWidth:"250px",align:"left",type:"combobox",combodata:this.comboboxDataHangHoa,defaultValue:"32",onChangeValue:!0},{prop:"maSoThue",label:"Mã số thuế",minWidth:"200px",align:"right"},{prop:"tienHang",label:"Tiền hàng",minWidth:"200px",align:"right",format:"currency",onChangeValue:!0},{prop:"thueSuat",label:"Thuế suất (%)",minWidth:"180px",align:"right  ",onChangeValue:!0},{prop:"tienThue",label:"Tiền thuế",minWidth:"180px",align:"center",format:"currency",onChangeValue:!0},{prop:"tongTien",label:"Tổng tiền",minWidth:"180px",format:"currency"},{prop:"ghiChu",label:"Ghi chú",minWidth:"250px"}]}}),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["setRowFlag","updateHoaDonMuaVaoCell","loadDmThueSuatMuaVao","updateHachToanCellV2"])),{},{handleRow:function(a,n){console.log("handle",a,n),this.setRowFlag({stateName:"hoaDonMuaVaoData",key:"id",value:n.id,flagName:a,row:n}),"saving"===a&&this.updateHachToanCellV2({findBy:"tkNo",findValue:n.tkThueDauVao,column:"soTien",value:this.tinhTongThanhTienTheoTkThueDauVao(n.tkThueDauVao)})},handlePressSpaceKey:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){var e;return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:if("nguoiMuaBan"!==a.col.prop){t.n=2;break}if(!n.popupRef){t.n=2;break}return t.n=1,n.popupRef.openPopup({title:"DANH MỤC CÔNG TY CUNG CẤP",width:"50%",columns:n.columnNhaCungCapPopupTable,data:n.lstNhaCungCap});case 1:e=t.v,e&&(n.selectedRow=e,n.updateHoaDonMuaVaoCell({id:a.row.id,column:"maSoThue",value:e.mst_kh_ncc}),n.updateHoaDonMuaVaoCell({id:a.row.id,column:"nguoiMuaBan",value:e.ten_congty}));case 2:return t.a(2)}}),t)})))()},handleChangeValue:function(a){"hangHoaChiuThue"===a.col.prop?a.row["hangHoaChiuThue"]&&(this.updateHoaDonMuaVaoCell({id:a.row.id,column:"thueSuat",value:this.getThueSuatFromMaLoaiHangHoa(a.row["hangHoaChiuThue"])}),this.updateHoaDonMuaVaoCell({id:a.row.id,column:"tienHang",value:this.tinhTongThanhTienNhapVatTu(this.getThueSuatFromMaLoaiHangHoa(a.row["hangHoaChiuThue"]))}),this.updateHoaDonMuaVaoCell({id:a.row.id,column:"tienThue",value:Number(a.row["tienHang"])*Number(a.row["thueSuat"]/100)}),this.updateHoaDonMuaVaoCell({id:a.row.id,column:"tongTien",value:Number(a.row["tienHang"])+Number(a.row["tienThue"])})):"tienHang"!==a.col.prop&&"thueSuat"!==a.col.prop&&"tienThue"!==a.col.prop||(a.row["tienHang"]&&a.row["thueSuat"]&&this.updateHoaDonMuaVaoCell({id:a.row.id,column:"tienThue",value:Number(a.row["tienHang"])*Number(a.row["thueSuat"]/100)}),a.row["tienHang"]&&a.row["tienThue"]&&this.updateHoaDonMuaVaoCell({id:a.row.id,column:"tongTien",value:Number(a.row["tienHang"])+Number(a.row["tienThue"])}))},onCellBlur:function(a){var n=a.row,t=a.col,e=a.value;console.log("Input mất focus:",t.prop,"giá trị:",e,"row",n),"soHoaDon"===t.prop&&this.updateHoaDonMuaVaoCell({id:n.id,column:"soHoaDon",value:this.chuanHoaSoHoaDon(e)})},getThueSuatFromMaLoaiHangHoa:function(a){var n=this.lstThueSuatMuaVao.find((function(n){return n.ma_loai==a}));return n?100*Number(n.thuesuat):0},tinhTongThanhTienNhapVatTu:function(a){return console.log("thueSuatFilter",a),this.nhapVatTuData.forEach((function(n,t){console.log("Dòng:",t,n,n.thueSuat,a)})),this.nhapVatTuData.filter((function(n){return n.thueSuat==a})).reduce((function(a,n){var t=Number(n.thanhTien)||0;return a+t}),0)},chuanHoaSoHoaDon:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;if(!a)return"";a=a.trim();var t=a.match(/^([A-Za-z0-9]+?)[-]?(\d+)$/);if(!t)return a;var e=t[1],o=t[2];return o=o.padStart(n,"0"),"".concat(e,"-").concat(o)},tinhTongThanhTienTheoTkThueDauVao:function(a){return Array.isArray(this.hoaDonMuaVaoData)?this.hoaDonMuaVaoData.filter((function(n){return n.tkThueDauVao===a})).reduce((function(a,n){var t=Number(n.tienThue)||0;return a+t}),0):0}}),mounted:function(){this.loadDmThueSuatMuaVao()}}),ea=ta,oa=Object(T["a"])(ea,aa,na,!1,null,null,null),ia=oa.exports,ha=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",[t("TableData",{attrs:{columns:a.columns,data:a.hoaDonBanRaData},on:{"space-key-pressed":a.handlePressSpaceKey,"handle-row":a.handleRow,"change-value":a.handleChangeValue,"cell-blur":a.onCellBlur}})],1)},la=[],ua={components:{TableData:j},props:["popupRef"],data:function(){return{columnNhaCungCapPopupTable:[{prop:"id",label:"ID",minWidth:"120px"},{prop:"cap",label:"Cấp",minWidth:"80px",align:"center"},{prop:"mst_kh_ncc",label:"Mã số thuế",minWidth:"100px"},{prop:"ten_congty",label:"Tên đơn vị",minWidth:"200px",maxWidth:"250px",wrapText:!0},{prop:"du_no",label:"Dư nợ",minWidth:"150px",align:"right",format:"currency"},{prop:"du_co",label:"Dư có",minWidth:"150px",align:"right",format:"currency"},{prop:"dia_chi",label:"Địa chỉ",minWidth:"250px",wrapText:!0},{prop:"huyen",label:"Huyện",minWidth:"150px"},{prop:"tinh",label:"Tỉnh",minWidth:"150px"},{prop:"dien_thoai",label:"Điện thoại",minWidth:"120px"},{prop:"ten_giamdoc",label:"Tên giám đốc",minWidth:"180px"},{prop:"ten_ketoan",label:"Tên kế toán",minWidth:"180px"},{prop:"linh_vuc_kd",label:"Lĩnh vực DK",minWidth:"150px"},{prop:"khach_hang",label:"Khách hàng",minWidth:"180px"},{prop:"nha_cungcap",label:"Nhà cung cấp",minWidth:"180px"},{prop:"tai_khoan",label:"Tài khoản",minWidth:"120px"},{prop:"ngan_hang",label:"Ngân hàng",minWidth:"200px"},{prop:"email",label:"Địa chỉ Email",minWidth:"200px"}]}},computed:Object(i["a"])(Object(i["a"])({},Object(_["d"])("nhapchungtu",["popup","lstTaiKhoan","lstKhoHang","lstVatTu","hoaDonBanRaData","lstNhaCungCap","lstThueSuatBanRa","nhatKyChung","xuatVatTuData"])),{},{comboboxDataHangHoa:function(){return this.lstThueSuatBanRa.map((function(a){return{code:a.ma_loai,name:a.ten_loai}}))},maKhachHang:function(){return this.nhatKyChung.chungTu.khachHang},columns:function(){return[{prop:"id",label:"ID",minWidth:"100px",align:"center",disableEditing:!0,identity:!0},{prop:"tkThueDauRa",label:"TK Thuế đầu ra",minWidth:"120px",defaultValue:this.maKhachHang},{prop:"hoaDonDt",label:"Hóa đơn ĐT",minWidth:"100px",align:"center",type:"boolean",defaultValue:!0},{prop:"soHoaDon",label:"Số hóa đơn",minWidth:"120px",align:"center",onLostForcus:!0},{prop:"ngayHoaDon",label:"Ngày hóa đơn",minWidth:"150px",align:"left",format:"date"},{prop:"nguoiMuaBan",label:"Người mua/bán",minWidth:"180px",align:"left",onSpaceKey:!0},{prop:"hangHoaChiuThue",label:"Hàng hóa chịu thuế",minWidth:"250px",align:"left",type:"combobox",combodata:this.comboboxDataHangHoa,defaultValue:"32",onChangeValue:!0},{prop:"maSoThue",label:"Mã số thuế",minWidth:"200px",align:"right"},{prop:"tienHang",label:"Tiền hàng",minWidth:"200px",align:"right",format:"currency",onChangeValue:!0},{prop:"thueSuat",label:"Thuế suất (%)",minWidth:"180px",align:"right  ",onChangeValue:!0},{prop:"tienThue",label:"Tiền thuế",minWidth:"180px",align:"center",format:"currency",onChangeValue:!0},{prop:"tongTien",label:"Tổng tiền",minWidth:"180px",format:"currency"},{prop:"ghiChu",label:"Ghi chú",minWidth:"250px"}]}}),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["setRowFlag","updateHoaDonBanRaCell","loadDmThueSuatBanRa","updateHachToanCellV2"])),{},{handleRow:function(a,n){console.log("handle",a,n),this.setRowFlag({stateName:"hoaDonBanRaData",key:"id",value:n.id,flagName:a,row:n}),"saving"===a&&this.updateHachToanCellV2({findBy:"tkCo",findValue:n.tkThueDauRa,column:"soTien",value:this.tinhTongThanhTienTheoTkThueDauRa(n.tkThueDauRa)})},handlePressSpaceKey:function(a){var n=this;return Object(p["a"])(Object(u["a"])().m((function t(){var e;return Object(u["a"])().w((function(t){while(1)switch(t.n){case 0:if("nguoiMuaBan"!==a.col.prop){t.n=2;break}if(!n.popupRef){t.n=2;break}return t.n=1,n.popupRef.openPopup({title:"DANH MỤC CÔNG TY CUNG CẤP",width:"50%",columns:n.columnNhaCungCapPopupTable,data:n.lstNhaCungCap});case 1:e=t.v,e&&(n.selectedRow=e,n.updateHoaDonBanRaCell({id:a.row.id,column:"maSoThue",value:e.mst_kh_ncc}),n.updateHoaDonBanRaCell({id:a.row.id,column:"nguoiMuaBan",value:e.ten_congty}));case 2:return t.a(2)}}),t)})))()},handleChangeValue:function(a){"hangHoaChiuThue"===a.col.prop?a.row["hangHoaChiuThue"]&&(this.updateHoaDonBanRaCell({id:a.row.id,column:"thueSuat",value:this.getThueSuatFromMaLoaiHangHoa(a.row["hangHoaChiuThue"])}),this.updateHoaDonBanRaCell({id:a.row.id,column:"tienHang",value:this.tinhTongThanhTienXuatVatTu(this.getThueSuatFromMaLoaiHangHoa(a.row["hangHoaChiuThue"]))}),this.updateHoaDonBanRaCell({id:a.row.id,column:"tienThue",value:Number(a.row["tienHang"])*Number(a.row["thueSuat"]/100)}),this.updateHoaDonBanRaCell({id:a.row.id,column:"tongTien",value:Number(a.row["tienHang"])+Number(a.row["tienThue"])})):"tienHang"!==a.col.prop&&"thueSuat"!==a.col.prop&&"tienThue"!==a.col.prop||(console.log("vao day roi"),a.row["tienHang"]&&a.row["thueSuat"]&&this.updateHoaDonBanRaCell({id:a.row.id,column:"tienThue",value:Number(a.row["tienHang"])*Number(a.row["thueSuat"]/100)}),a.row["tienHang"]&&a.row["tienThue"]&&this.updateHoaDonBanRaCell({id:a.row.id,column:"tongTien",value:Number(a.row["tienHang"])+Number(a.row["tienThue"])}))},onCellBlur:function(a){var n=a.row,t=a.col,e=a.value;console.log("Input mất focus:",t.prop,"giá trị:",e,"row",n),"soHoaDon"===t.prop&&this.updateHoaDonBanRaCell({id:n.id,column:"soHoaDon",value:this.chuanHoaSoHoaDon(e)})},getThueSuatFromMaLoaiHangHoa:function(a){var n=this.lstThueSuatBanRa.find((function(n){return n.ma_loai==a}));return n?100*Number(n.thuesuat):0},tinhTongThanhTienXuatVatTu:function(a){return console.log("thueSuatFilter",a),this.xuatVatTuData.forEach((function(n,t){console.log("Dòng:",t,n,n.thueSuat,a)})),this.xuatVatTuData.filter((function(n){return n.thueSuat==a})).reduce((function(a,n){var t=Number(n.thanhTien)||0;return a+t}),0)},chuanHoaSoHoaDon:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;if(!a)return"";a=a.trim();var t=a.match(/^([A-Za-z0-9]+?)[-]?(\d+)$/);if(!t)return a;var e=t[1],o=t[2];return o=o.padStart(n,"0"),"".concat(e,"-").concat(o)},tinhTongThanhTienTheoTkThueDauRa:function(a){return Array.isArray(this.hoaDonBanRaData)?this.hoaDonBanRaData.filter((function(n){return n.tkThueDauRa===a})).reduce((function(a,n){var t=Number(n.tienThue)||0;return a+t}),0):0}}),mounted:function(){this.loadDmThueSuatBanRa()}},pa=ua,ca=Object(T["a"])(pa,ha,la,!1,null,null,null),ra=ca.exports,sa=function(){var a=this,n=a.$createElement,t=a._self._c||n;return a.isOpen?t("div",{staticClass:"popup-overlay"},[t("div",{staticClass:"popup-content",style:{width:a.width}},[t("div",{staticClass:"popup-header"},[a._v(" "+a._s(a.title)+" "),t("button",{staticClass:"popup-close",on:{click:a.closePopup}},[a._v("Đóng")])]),t("div",{staticStyle:{"margin-bottom":"8px","text-align":"right"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.searchText,expression:"searchText"}],staticStyle:{padding:"6px 10px",border:"1px solid #ccc","border-radius":"4px",width:"250px"},attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:a.searchText},on:{input:function(n){n.target.composing||(a.searchText=n.target.value)}}})]),t("div",{staticClass:"popup-body"},[t("table",{staticClass:"data-table"},[t("thead",[t("tr",a._l(a.columns,(function(n){return t("th",{key:n.prop,style:a.getColumnStyle(n)},[a._v(" "+a._s(n.label)+" ")])})),0)]),t("tbody",a._l(a.filteredData,(function(n,e){return t("tr",{key:e,on:{dblclick:function(t){return a.selectRow(n)}}},a._l(a.columns,(function(e){return t("td",{key:e.prop,style:a.getColumnStyle(e,!0)},[a._v(" "+a._s(a.formatCell(n[e.prop],e))+" ")])})),0)})),0)])])])]):a._e()},ga=[],da=(t("caad"),t("2532"),t("9a9a"),{data:function(){return{searchText:"",isOpen:!1,resolve:null,title:"",width:"50%",columns:[],data:[]}},computed:{filteredData:function(){var a=this;if(!this.searchText)return this.data;var n=this.searchText.toLowerCase();return this.data.filter((function(t){return a.columns.some((function(a){var e=t[a.prop];return e&&e.toString().toLowerCase().includes(n)}))}))}},methods:{openPopup:function(a){var n=this,t=a.title,e=a.width,o=a.columns,i=a.data;return this.title=t||"Danh sách",this.width=e||"50%",this.columns=o||[],this.data=i||[],this.isOpen=!0,this.selectedRow=null,new Promise((function(a){n.resolve=a}))},selectRow:function(a){this.selectedRow=a,this.resolve(a),this.isOpen=!1},closePopup:function(){this.resolve(null),this.isOpen=!1},getColumnStyle:function(a){return{width:a.width?"number"===typeof a.width?a.width+"px":a.width:"auto",minWidth:a.minWidth?"number"===typeof a.minWidth?a.minWidth+"px":a.minWidth:"auto",maxWidth:a.maxWidth?"number"===typeof a.maxWidth?a.maxWidth+"px":a.maxWidth:"auto",textAlign:a.align||"left",whiteSpace:a.wrapText?"normal":"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},formatCell:function(a,n){return"currency"===n.format?(new Intl.NumberFormat).format(a):"boolean"===n.format?a?"✔":"✖":a}}}),Ta=da,ma=(t("c87e"),Object(T["a"])(Ta,sa,ga,!1,null,null,null)),ba=ma.exports,fa={components:{NhatKyChung:N,HachToan:L,NhapVatTu:U,XuatVatTu:Q,HoaDonMuaVao:ia,HoaDonBanRa:ra,TablePopup:ba},data:function(){return{popupRef:null,activeTab:"TAB_HACH_TOAN",isHachToan:!1,isNhapVatTu:!1,isXuatVatTu:!1,isHoaDonMuaVao:!1,isHoaDonBanRa:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(_["d"])("nhapchungtu",["nhatKyChung","lstKhachHang","lstNhaCungCap","lstTaiKhoan"])),{},{popupData:function(){return this.popup.data},popupColumns:function(){return this.popup.columns},popupWidth:function(){return this.popup.width},popupFullscreen:function(){return this.popup.fullscreen},popupTitle:function(){return this.popup.title}}),methods:Object(i["a"])(Object(i["a"])({},Object(_["b"])("nhapchungtu",["loaiChungTu","loadKhachHang","loadNhaCungCap","loadTaiKhoan","loadHinhThucTT","loadVatTu","loadKhoHang","loadNhomHang","loadCanBo141","handleRowSelected","updateLoaiChungTu","updateTabType","sendData","initData"])),{},{onSubmit:function(){console.log("submit!")},getLoaiChungTu:function(){var a=this.$route.path,n=a.split("/");if(!(n.length<3)){var t=n[2];this.updateLoaiChungTu(t);var e={phieuthutienmat:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!0,isHoaDonMuaVao:!1,isHoaDonBanRa:!0},phieuchitienmat:{isHachToan:!0,isNhapVatTu:!0,isXuatVatTu:!1,isHoaDonMuaVao:!0,isHoaDonBanRa:!1},phieunhapvattucongcu:{isHachToan:!0,isNhapVatTu:!0,isXuatVatTu:!1,isHoaDonMuaVao:!0,isHoaDonBanRa:!1},phieuxuatvattucongcu:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!0,isHoaDonMuaVao:!1,isHoaDonBanRa:!0},banhangthutiensau:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!0,isHoaDonMuaVao:!1,isHoaDonBanRa:!0},chungtunganhang:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!1,isHoaDonMuaVao:!0,isHoaDonBanRa:!1},chungtughiso:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!1,isHoaDonMuaVao:!1,isHoaDonBanRa:!1},chungtuluuchuyennoibo:{isHachToan:!0,isNhapVatTu:!0,isXuatVatTu:!0,isHoaDonMuaVao:!1,isHoaDonBanRa:!1},tangtaisan:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!1,isHoaDonMuaVao:!0,isHoaDonBanRa:!1},giamtaisan:{isHachToan:!0,isNhapVatTu:!1,isXuatVatTu:!1,isHoaDonMuaVao:!1,isHoaDonBanRa:!0}};Object.assign(this,e[t]||{})}},handleTabClick:function(a){this.updateTabType(a.name)}}),mounted:function(){this.popupRef=this.$refs.popupRef,this.getLoaiChungTu(),this.loadKhachHang(),this.loadNhaCungCap(),this.loadTaiKhoan(),this.loadHinhThucTT(),this.loadVatTu(),this.loadKhoHang(),this.loadNhomHang(),this.loadCanBo141()}},Ca=fa,wa=(t("360c"),Object(T["a"])(Ca,e,o,!1,null,null,null));n["default"]=wa.exports},"95e5":function(a,n,t){"use strict";var e=function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("div",{staticClass:"floating-label-input",class:{"is-focused":a.isFocused||a.value,"is-disabled":a.disabled}},[t("el-input",a._b({attrs:{type:a.inputType,placeholder:a.placeholder,clearable:a.clearable,disabled:a.disabled,readonly:a.readonly,"prefix-icon":a.prefixIcon,"suffix-icon":a.showPasswordToggle?a.passwordToggleIcon:a.suffixIcon},on:{focus:a.onFocus,blur:a.onBlur,input:a.onInput,change:a.onChange,"suffix-icon-click":a.handleSuffixClick},model:{value:a.inputValue,callback:function(n){a.inputValue=n},expression:"inputValue"}},"el-input",a.$attrs,!1)),t("label",[a._v(a._s(a.label))])],1)},o=[],i=(t("a9e3"),{name:"FloatingInput",props:{value:[String,Number],label:String,placeholder:{type:String,default:" "},type:{type:String,default:"text"},clearable:Boolean,disabled:Boolean,readonly:Boolean,prefixIcon:String,suffixIcon:String,showPassword:Boolean},data:function(){return{isFocused:!1,passwordVisible:!1}},computed:{inputValue:{get:function(){return this.value},set:function(a){this.$emit("input",a)}},inputType:function(){return this.showPassword?this.passwordVisible?"text":"password":this.type},showPasswordToggle:function(){return this.showPassword&&"password"===this.type},passwordToggleIcon:function(){return this.passwordVisible?"el-icon-view":"el-icon-view-off"}},methods:{onFocus:function(a){this.isFocused=!0,this.$emit("focus",a)},onBlur:function(a){this.isFocused=!1,this.$emit("blur",a)},onInput:function(a){this.$emit("input",a)},onChange:function(a){this.$emit("change",a)},handleSuffixClick:function(){this.showPasswordToggle&&(this.passwordVisible=!this.passwordVisible),this.$emit("suffix-icon-click")}}}),h=i,l=(t("8147"),t("2877")),u=Object(l["a"])(h,e,o,!1,null,"600e13cb",null);n["a"]=u.exports},"9c1b":function(a,n,t){},bcb5:function(a,n,t){"use strict";t("4add")},c87e:function(a,n,t){"use strict";t("8af5")},e4ae:function(a,n,t){},e737:function(a,n,t){"use strict";t("9c1b")}}]);