(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-113eee80"],{"03e8":function(a,t,e){"use strict";e("5cc7")},"2e4b":function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"chiphi-tratruoc-container"},[e("el-card",[e("div",{staticStyle:{"margin-bottom":"20px",display:"flex",gap:"10px","align-items":"center","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex",gap:"10px","align-items":"center"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"Nhập MST, số hiệu TK, mã kho hoặc tên tài sản để tìm kiếm",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.handleSearch(t)}},model:{value:a.searchQuery,callback:function(t){a.searchQuery=t},expression:"searchQuery"}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:a.handleSearch}},[a._v("Search")])],1),e("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:a.openCreateDialog}},[a._v("Thêm mới")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:a.chiphiTratruocList,border:"","empty-text":"Không có dữ liệu","max-height":"600"}},[e("el-table-column",{attrs:{label:"STT",type:"index",width:"60",index:a.indexMethod,align:"center"}}),a._e(),e("el-table-column",{attrs:{prop:"sohieutk",label:"Số hiệu TK",width:"120"}}),e("el-table-column",{attrs:{prop:"ma_kho",label:"Mã kho",width:"100"}}),e("el-table-column",{attrs:{prop:"ma_nhom",label:"Mã nhóm",width:"100"}}),e("el-table-column",{attrs:{prop:"ma_taisan",label:"Mã tài sản",width:"120"}}),e("el-table-column",{attrs:{prop:"ten_taisan",label:"Tên tài sản","min-width":"200"}}),e("el-table-column",{attrs:{prop:"dvt",label:"Đơn vị tính",width:"100"}}),e("el-table-column",{attrs:{prop:"ngaylap_the",label:"Ngày lập thẻ",width:"120"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatDate(t.row.ngaylap_the))+" ")]}}])}),e("el-table-column",{attrs:{prop:"donvi_quanly",label:"Mã đơn vị quản lý",width:"140"}}),e("el-table-column",{attrs:{prop:"ten_donvi_quanly",label:"Tên đơn vị quản lý","min-width":"150"}}),e("el-table-column",{attrs:{prop:"nguonvon",label:"Nguồn vốn",width:"120"}}),e("el-table-column",{attrs:{prop:"soluong_dauky",label:"Số lượng đầu kỳ",width:"130",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatNumber(t.row.soluong_dauky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"dongia",label:"Đơn giá",width:"120",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatCurrency(t.row.dongia))+" ")]}}])}),e("el-table-column",{attrs:{prop:"nguyengia",label:"Nguyên giá",width:"120",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatCurrency(t.row.nguyengia))+" ")]}}])}),e("el-table-column",{attrs:{prop:"haomon_luyke",label:"Hao mòn lũy kế",width:"140",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatCurrency(t.row.haomon_luyke))+" ")]}}])}),e("el-table-column",{attrs:{prop:"giatri_conlai",label:"Giá trị còn lại",width:"130",align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatCurrency(t.row.giatri_conlai))+" ")]}}])}),e("el-table-column",{attrs:{prop:"so_thang_phan_bo",label:"Số tháng phân bổ",width:"140",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatNumber(t.row.so_thang_phan_bo))+" ")]}}])}),e("el-table-column",{attrs:{prop:"ky_phanbo",label:"Kỳ phân bổ",width:"100"}}),e("el-table-column",{attrs:{prop:"sothang_phanbo",label:"Số tháng phân bổ",width:"140",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(" "+a._s(a.formatNumber(t.row.sothang_phanbo))+" ")]}}])}),e("el-table-column",{attrs:{prop:"taikhoan_phanbo",label:"TK phân bổ",width:"120"}}),e("el-table-column",{attrs:{prop:"ma_kho_ct",label:"Mã kho CT",width:"100"}}),e("el-table-column",{attrs:{prop:"ma_nhom_ct",label:"Mã nhóm CT",width:"100"}}),e("el-table-column",{attrs:{prop:"chitiet_taikhoan_phanbo",label:"Chi tiết TK phân bổ",width:"150"}}),e("el-table-column",{attrs:{prop:"congdoan_sanxuat",label:"Công đoạn sản xuất",width:"150"}}),e("el-table-column",{attrs:{prop:"trang_thai",label:"Trạng thái",width:"100",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-tag",{attrs:{type:1===t.row.trang_thai?"success":"danger"}},[a._v(" "+a._s(1===t.row.trang_thai?"Hoạt động":"Vô hiệu")+" ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"Action",width:"280",fixed:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-info"},on:{click:function(e){return a.openDetailDialog(t.row)}}},[a._v("Detail")]),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(e){return a.openEditDialog(t.row)}}},[a._v("Edit")]),e("el-button",{attrs:{type:1===t.row.trang_thai?"danger":"warning",size:"small",icon:1===t.row.trang_thai?"el-icon-delete":"el-icon-check"},on:{click:function(e){1===t.row.trang_thai?a.handleDisable(t.row):a.handleEnable(t.row)}}},[a._v(a._s(1===t.row.trang_thai?"Disable":"Enable"))])]}}])})],1),e("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":a.pagination.page,"page-size":a.pagination.pageSize,total:a.pagination.total},on:{"current-change":a.handlePageChange}})],1)],1),e("ChiphiTratruocForm",{attrs:{visible:a.formDialog.visible,"is-edit":a.formDialog.isEdit,"chiphi-tratruoc-data":a.formDialog.chiphiTratruocData},on:{"update:visible":function(t){return a.$set(a.formDialog,"visible",t)},success:a.handleFormSuccess,close:a.handleFormClose}}),e("ChiphiTratruocDetail",{attrs:{visible:a.detailDialog.visible,"chiphi-tratruoc-data":a.detailDialog.chiphiTratruocData},on:{"update:visible":function(t){return a.$set(a.detailDialog,"visible",t)},close:a.handleDetailClose}})],1)},i=[],n=e("5530"),r=e("c14f"),s=e("1da1"),l=(e("99af"),e("b775")),c=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-dialog",{attrs:{title:a.isEdit?"Chỉnh sửa chi phí trả trước":"Thêm mới chi phí trả trước",visible:a.visible,width:"1000px","before-close":a.handleClose},on:{"update:visible":function(t){a.visible=t}}},[a.formLoading?e("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center","min-height":"200px"}},[e("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"32px","margin-right":"8px"}}),a._v(" Đang tải dữ liệu... ")]):e("el-form",{ref:"form",attrs:{model:a.formData,rules:a.rules,"label-width":"140px","label-position":"left"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"MST",prop:"mst"}},[e("el-input",{attrs:{placeholder:"Nhập MST",clearable:""},model:{value:a.formData.mst,callback:function(t){a.$set(a.formData,"mst",t)},expression:"formData.mst"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số hiệu TK",prop:"sohieutk"}},[e("el-input",{attrs:{placeholder:"Nhập số hiệu tài khoản",clearable:""},model:{value:a.formData.sohieutk,callback:function(t){a.$set(a.formData,"sohieutk",t)},expression:"formData.sohieutk"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã kho",prop:"ma_kho"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn mã kho",clearable:"",filterable:""},on:{change:a.handleMaKhoChange},model:{value:a.formData.ma_kho,callback:function(t){a.$set(a.formData,"ma_kho",t)},expression:"formData.ma_kho"}},a._l(a.khoOptions,(function(a){return e("el-option",{key:a.ma_kho,attrs:{label:a.ma_kho+" - "+a.ten_kho,value:a.ma_kho}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã nhóm",prop:"ma_nhom"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn mã nhóm",clearable:"",filterable:""},on:{change:a.handleMaNhomChange},model:{value:a.formData.ma_nhom,callback:function(t){a.$set(a.formData,"ma_nhom",t)},expression:"formData.ma_nhom"}},a._l(a.nhomOptions,(function(a){return e("el-option",{key:a.ma_nhom,attrs:{label:a.ma_nhom+" - "+a.ten_nhom,value:a.ma_nhom}})})),1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã tài sản",prop:"ma_taisan"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn mã tài sản",clearable:"",filterable:""},on:{change:a.handleMaTaisanChange},model:{value:a.formData.ma_taisan,callback:function(t){a.$set(a.formData,"ma_taisan",t)},expression:"formData.ma_taisan"}},a._l(a.taisanOptions,(function(a){return e("el-option",{key:a.ma_taisan,attrs:{label:a.ma_taisan+" - "+a.ten_taisan,value:a.ma_taisan}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Đơn vị tính",prop:"dvt"}},[e("el-input",{attrs:{placeholder:"Nhập đơn vị tính",clearable:""},model:{value:a.formData.dvt,callback:function(t){a.$set(a.formData,"dvt",t)},expression:"formData.dvt"}})],1)],1)],1),e("el-form-item",{attrs:{label:"Tên tài sản",prop:"ten_taisan"}},[e("el-input",{attrs:{placeholder:"Nhập tên tài sản",clearable:""},model:{value:a.formData.ten_taisan,callback:function(t){a.$set(a.formData,"ten_taisan",t)},expression:"formData.ten_taisan"}})],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Ngày lập thẻ",prop:"ngaylap_the"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Chọn ngày lập thẻ",format:"dd/MM/yyyy","value-format":"yyyy-MM-dd"},model:{value:a.formData.ngaylap_the,callback:function(t){a.$set(a.formData,"ngaylap_the",t)},expression:"formData.ngaylap_the"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã đơn vị quản lý",prop:"donvi_quanly"}},[e("el-input",{attrs:{placeholder:"Nhập mã đơn vị quản lý",clearable:""},model:{value:a.formData.donvi_quanly,callback:function(t){a.$set(a.formData,"donvi_quanly",t)},expression:"formData.donvi_quanly"}})],1)],1)],1),e("el-form-item",{attrs:{label:"Tên đơn vị quản lý",prop:"ten_donvi_quanly"}},[e("el-input",{attrs:{placeholder:"Nhập tên đơn vị quản lý",clearable:""},model:{value:a.formData.ten_donvi_quanly,callback:function(t){a.$set(a.formData,"ten_donvi_quanly",t)},expression:"formData.ten_donvi_quanly"}})],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Nguồn vốn",prop:"nguonvon"}},[e("el-input",{attrs:{placeholder:"Nhập nguồn vốn",clearable:""},model:{value:a.formData.nguonvon,callback:function(t){a.$set(a.formData,"nguonvon",t)},expression:"formData.nguonvon"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số lượng đầu kỳ",prop:"soluong_dauky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,step:1,min:0,placeholder:"0"},model:{value:a.formData.soluong_dauky,callback:function(t){a.$set(a.formData,"soluong_dauky",t)},expression:"formData.soluong_dauky"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Đơn giá",prop:"dongia"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:a.formData.dongia,callback:function(t){a.$set(a.formData,"dongia",t)},expression:"formData.dongia"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Nguyên giá",prop:"nguyengia"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:a.formData.nguyengia,callback:function(t){a.$set(a.formData,"nguyengia",t)},expression:"formData.nguyengia"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Hao mòn lũy kế",prop:"haomon_luyke"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:a.formData.haomon_luyke,callback:function(t){a.$set(a.formData,"haomon_luyke",t)},expression:"formData.haomon_luyke"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Giá trị còn lại",prop:"giatri_conlai"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:a.formData.giatri_conlai,callback:function(t){a.$set(a.formData,"giatri_conlai",t)},expression:"formData.giatri_conlai"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số tháng phân bổ",prop:"so_thang_phan_bo"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1,min:0,placeholder:"0"},model:{value:a.formData.so_thang_phan_bo,callback:function(t){a.$set(a.formData,"so_thang_phan_bo",t)},expression:"formData.so_thang_phan_bo"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Kỳ phân bổ",prop:"ky_phanbo"}},[e("el-input",{attrs:{placeholder:"Nhập kỳ phân bổ",clearable:""},model:{value:a.formData.ky_phanbo,callback:function(t){a.$set(a.formData,"ky_phanbo",t)},expression:"formData.ky_phanbo"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số tháng phân bổ",prop:"sothang_phanbo"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1,min:0,placeholder:"0"},model:{value:a.formData.sothang_phanbo,callback:function(t){a.$set(a.formData,"sothang_phanbo",t)},expression:"formData.sothang_phanbo"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"TK phân bổ",prop:"taikhoan_phanbo"}},[e("el-input",{attrs:{placeholder:"Nhập tài khoản phân bổ",clearable:""},model:{value:a.formData.taikhoan_phanbo,callback:function(t){a.$set(a.formData,"taikhoan_phanbo",t)},expression:"formData.taikhoan_phanbo"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã kho CT",prop:"ma_kho_ct"}},[e("el-input",{attrs:{placeholder:"Nhập mã kho CT",clearable:""},model:{value:a.formData.ma_kho_ct,callback:function(t){a.$set(a.formData,"ma_kho_ct",t)},expression:"formData.ma_kho_ct"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã nhóm CT",prop:"ma_nhom_ct"}},[e("el-input",{attrs:{placeholder:"Nhập mã nhóm CT",clearable:""},model:{value:a.formData.ma_nhom_ct,callback:function(t){a.$set(a.formData,"ma_nhom_ct",t)},expression:"formData.ma_nhom_ct"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Chi tiết TK phân bổ",prop:"chitiet_taikhoan_phanbo"}},[e("el-input",{attrs:{placeholder:"Nhập chi tiết TK phân bổ",clearable:""},model:{value:a.formData.chitiet_taikhoan_phanbo,callback:function(t){a.$set(a.formData,"chitiet_taikhoan_phanbo",t)},expression:"formData.chitiet_taikhoan_phanbo"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Công đoạn sản xuất",prop:"congdoan_sanxuat"}},[e("el-input",{attrs:{placeholder:"Nhập công đoạn sản xuất",clearable:""},model:{value:a.formData.congdoan_sanxuat,callback:function(t){a.$set(a.formData,"congdoan_sanxuat",t)},expression:"formData.congdoan_sanxuat"}})],1)],1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:a.handleClose}},[a._v("Hủy")]),e("el-button",{attrs:{type:"primary",loading:a.loading},on:{click:a.handleSubmit}},[a._v(" "+a._s(a.isEdit?"Cập nhật":"Thêm mới")+" ")])],1)],1)},h=[],u=(e("7db0"),e("b64b"),e("d3b7"),e("0643"),e("fffc"),"http://localhost:8080/api"),m={name:"ChiphiTratruocForm",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},chiphiTratruocData:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,formLoading:!1,khoOptions:[],nhomOptions:[],taisanOptions:[],formData:{mst:"",sohieutk:"",ma_kho:"",ma_nhom:"",ma_taisan:"",ten_taisan:"",dvt:"",ngaylap_the:"",donvi_quanly:"",ten_donvi_quanly:"",nguonvon:"",soluong_dauky:0,dongia:0,nguyengia:0,haomon_luyke:0,giatri_conlai:0,so_thang_phan_bo:0,ky_phanbo:"",sothang_phanbo:0,taikhoan_phanbo:"",ma_kho_ct:"",ma_nhom_ct:"",chitiet_taikhoan_phanbo:"",congdoan_sanxuat:""},rules:{mst:[{required:!0,message:"Vui lòng nhập MST",trigger:"blur"}],sohieutk:[{required:!0,message:"Vui lòng nhập số hiệu tài khoản",trigger:"blur"}],ma_kho:[{required:!0,message:"Vui lòng chọn mã kho",trigger:"change"}],ma_nhom:[{required:!0,message:"Vui lòng chọn mã nhóm",trigger:"change"}],ma_taisan:[{required:!0,message:"Vui lòng chọn mã tài sản",trigger:"change"}],ten_taisan:[{required:!0,message:"Vui lòng nhập tên tài sản",trigger:"blur"}]}}},watch:{visible:function(a){var t=this;return Object(s["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:if(!a){e.n=2;break}return t.formLoading=!0,e.n=1,t.initForm();case 1:t.formLoading=!1,t.loadKhoOptions();case 2:return e.a(2)}}),e)})))()},chiphiTratruocData:{handler:function(a){a&&Object.keys(a).length>0&&(this.formData=Object(n["a"])({},a))},deep:!0},"formData.mst":function(a){this.isEdit||(this.formData.ma_kho="",this.formData.ma_nhom="",this.formData.ma_taisan="",this.nhomOptions=[],this.taisanOptions=[])},"formData.sohieutk":function(a){this.isEdit||(this.formData.ma_kho="",this.formData.ma_nhom="",this.formData.ma_taisan="",this.nhomOptions=[],this.taisanOptions=[])},"formData.ma_kho":function(a){a&&this.formData.mst&&this.formData.sohieutk&&this.loadNhomOptions(this.formData.mst,this.formData.sohieutk,a),this.isEdit||(this.formData.ma_nhom="",this.formData.ma_taisan="",this.taisanOptions=[])},"formData.ma_nhom":function(a){a&&this.formData.mst&&this.formData.sohieutk&&this.formData.ma_kho&&this.loadTaisanOptions(this.formData.mst,this.formData.sohieutk,this.formData.ma_kho,a),this.isEdit||(this.formData.ma_taisan="")}},methods:{loadKhoOptions:function(){var a=this;return Object(s["a"])(Object(r["a"])().m((function t(){var e,o;return Object(r["a"])().w((function(t){while(1)switch(t.n){case 0:return t.p=0,t.n=1,l["a"].post("".concat(u,"/dm/get-list"),{table_code:"tbldmkhohang",size:1e3,page:1});case 1:e=t.v,a.khoOptions=e.data&&e.data.items?e.data.items:[],t.n=3;break;case 2:t.p=2,o=t.v,console.error("Error loading kho options:",o),a.$message.error("Không thể tải danh sách kho");case 3:return t.a(2)}}),t,null,[[0,2]])})))()},loadNhomOptions:function(a,t,e){var o=this;return Object(s["a"])(Object(r["a"])().m((function i(){var n,s;return Object(r["a"])().w((function(i){while(1)switch(i.n){case 0:if(a&&t&&e){i.n=1;break}return o.nhomOptions=[],i.a(2);case 1:return i.p=1,i.n=2,l["a"].post("".concat(u,"/dm/get-list"),{table_code:"tbldmnhomhang",size:1e3,page:1,filters:{mst:a,sohieutk:t,ma_kho:e}});case 2:n=i.v,o.nhomOptions=n.data&&n.data.items?n.data.items:[],i.n=4;break;case 3:i.p=3,s=i.v,console.error("Error loading nhom options:",s),o.$message.error("Không thể tải danh sách nhóm");case 4:return i.a(2)}}),i,null,[[1,3]])})))()},loadTaisanOptions:function(a,t,e,o){var i=this;return Object(s["a"])(Object(r["a"])().m((function n(){var s,c;return Object(r["a"])().w((function(n){while(1)switch(n.n){case 0:if(a&&t&&e&&o){n.n=1;break}return i.taisanOptions=[],n.a(2);case 1:return n.p=1,n.n=2,l["a"].post("".concat(u,"/dm/get-list"),{table_code:"tbldmtaisan",size:1e3,page:1,filters:{mst:a,sohieutk:t,ma_kho:e,ma_nhom:o}});case 2:s=n.v,i.taisanOptions=s.data&&s.data.items?s.data.items:[],n.n=4;break;case 3:n.p=3,c=n.v,console.error("Error loading taisan options:",c),i.$message.error("Không thể tải danh sách tài sản");case 4:return n.a(2)}}),n,null,[[1,3]])})))()},handleMaKhoChange:function(){this.formData.ma_nhom="",this.formData.ma_taisan="",this.formData.ten_taisan="",this.formData.dvt="",this.loadNhomOptions(this.formData.mst,this.formData.sohieutk,this.formData.ma_kho)},handleMaNhomChange:function(){this.formData.ma_taisan="",this.formData.ten_taisan="",this.formData.dvt="",this.loadTaisanOptions(this.formData.mst,this.formData.sohieutk,this.formData.ma_kho,this.formData.ma_nhom)},handleMaTaisanChange:function(){var a=this,t=this.taisanOptions.find((function(t){return t.ma_taisan===a.formData.ma_taisan}));t&&(this.formData.ten_taisan=t.ten_taisan||"",this.formData.dvt=t.dvt||"")},initForm:function(){var a=this;return Object(s["a"])(Object(r["a"])().m((function t(){return Object(r["a"])().w((function(t){while(1)switch(t.n){case 0:if(!a.isEdit||!a.chiphiTratruocData){t.n=3;break}if(a.formData={mst:a.chiphiTratruocData.mst||"",sohieutk:a.chiphiTratruocData.sohieutk||"",ma_kho:a.chiphiTratruocData.ma_kho||"",ma_nhom:a.chiphiTratruocData.ma_nhom||"",ma_taisan:a.chiphiTratruocData.ma_taisan||"",ten_taisan:a.chiphiTratruocData.ten_taisan||"",dvt:a.chiphiTratruocData.dvt||"",ngaylap_the:a.chiphiTratruocData.ngaylap_the||"",donvi_quanly:a.chiphiTratruocData.donvi_quanly||"",ten_donvi_quanly:a.chiphiTratruocData.ten_donvi_quanly||"",nguonvon:a.chiphiTratruocData.nguonvon||"",soluong_dauky:a.chiphiTratruocData.soluong_dauky||0,dongia:a.chiphiTratruocData.dongia||0,nguyengia:a.chiphiTratruocData.nguyengia||0,haomon_luyke:a.chiphiTratruocData.haomon_luyke||0,giatri_conlai:a.chiphiTratruocData.giatri_conlai||0,so_thang_phan_bo:a.chiphiTratruocData.so_thang_phan_bo||0,ky_phanbo:a.chiphiTratruocData.ky_phanbo||"",sothang_phanbo:a.chiphiTratruocData.sothang_phanbo||0,taikhoan_phanbo:a.chiphiTratruocData.taikhoan_phanbo||"",ma_kho_ct:a.chiphiTratruocData.ma_kho_ct||"",ma_nhom_ct:a.chiphiTratruocData.ma_nhom_ct||"",chitiet_taikhoan_phanbo:a.chiphiTratruocData.chitiet_taikhoan_phanbo||"",congdoan_sanxuat:a.chiphiTratruocData.congdoan_sanxuat||""},!a.formData.ma_kho){t.n=1;break}return t.n=1,a.loadNhomOptions(a.formData.mst,a.formData.sohieutk,a.formData.ma_kho);case 1:if(!a.formData.ma_kho||!a.formData.ma_nhom){t.n=2;break}return t.n=2,a.loadTaisanOptions(a.formData.mst,a.formData.sohieutk,a.formData.ma_kho,a.formData.ma_nhom);case 2:t.n=4;break;case 3:a.formData={mst:"",sohieutk:"",ma_kho:"",ma_nhom:"",ma_taisan:"",ten_taisan:"",dvt:"",ngaylap_the:"",donvi_quanly:"",ten_donvi_quanly:"",nguonvon:"",soluong_dauky:0,dongia:0,nguyengia:0,haomon_luyke:0,giatri_conlai:0,so_thang_phan_bo:0,ky_phanbo:"",sothang_phanbo:0,taikhoan_phanbo:"",ma_kho_ct:"",ma_nhom_ct:"",chitiet_taikhoan_phanbo:"",congdoan_sanxuat:""};case 4:a.$nextTick((function(){a.$refs.form&&a.$refs.form.clearValidate()}));case 5:return t.a(2)}}),t)})))()},handleSubmit:function(){var a=this;return Object(s["a"])(Object(r["a"])().m((function t(){var e,o,i,s;return Object(r["a"])().w((function(t){while(1)switch(t.n){case 0:return t.p=0,t.n=1,a.$refs.form.validate();case 1:if(e=t.v,e){t.n=2;break}return t.a(2);case 2:if(a.loading=!0,o=Object(n["a"])({table_code:"tbldmchiphi_tratruoc"},a.formData),!a.isEdit){t.n=4;break}return t.n=3,l["a"].post("".concat(u,"/dm/upsert"),o);case 3:i=t.v,a.$message.success("Cập nhật chi phí trả trước thành công"),t.n=6;break;case 4:return t.n=5,l["a"].post("".concat(u,"/dm/upsert"),o);case 5:i=t.v,a.$message.success("Thêm mới chi phí trả trước thành công");case 6:a.$emit("success",i.data),a.handleClose(),t.n=8;break;case 7:t.p=7,s=t.v,console.error("Error submitting form:",s),a.$message.error("Có lỗi xảy ra khi lưu dữ liệu");case 8:return t.p=8,a.loading=!1,t.f(8);case 9:return t.a(2)}}),t,null,[[0,7,8,9]])})))()},handleClose:function(){this.$refs.form&&this.$refs.form.resetFields(),this.$emit("update:visible",!1),this.$emit("close")}}},p=m,d=(e("487a"),e("2877")),f=Object(d["a"])(p,c,h,!1,null,"6b844d3a",null),_=f.exports,b=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-dialog",{attrs:{title:"Chi tiết chi phí trả trước",visible:a.visible,width:"1000px","before-close":a.handleClose},on:{"update:visible":function(t){a.visible=t}}},[a.chiphiTratruocData?e("div",{staticClass:"chiphi-tratruoc-detail-form"},[e("div",{staticClass:"section-title"},[a._v("Thông tin chung")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("MST:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.mst||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Số hiệu TK:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.sohieutk||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Mã kho:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ma_kho||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Mã nhóm:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ma_nhom||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Mã tài sản:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ma_taisan||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Đơn vị tính:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.dvt||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Tên tài sản:")]),e("div",{staticClass:"form-value",staticStyle:{"grid-column":"span 3"}},[a._v(a._s(a.chiphiTratruocData.ten_taisan||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Ngày lập thẻ:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.formatDate(a.chiphiTratruocData.ngaylap_the)))]),e("div",{staticClass:"form-label"},[a._v("Mã đơn vị quản lý:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.donvi_quanly||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Tên đơn vị quản lý:")]),e("div",{staticClass:"form-value",staticStyle:{"grid-column":"span 3"}},[a._v(a._s(a.chiphiTratruocData.ten_donvi_quanly||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Nguồn vốn:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.nguonvon||"N/A"))])]),e("div",{staticClass:"section-title"},[a._v("Thông tin kế toán")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Số lượng đầu kỳ:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatNumber(a.chiphiTratruocData.soluong_dauky)))]),e("div",{staticClass:"form-label"},[a._v("Đơn giá:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatCurrency(a.chiphiTratruocData.dongia)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Nguyên giá:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatCurrency(a.chiphiTratruocData.nguyengia)))]),e("div",{staticClass:"form-label"},[a._v("Hao mòn lũy kế:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatCurrency(a.chiphiTratruocData.haomon_luyke)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Giá trị còn lại:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatCurrency(a.chiphiTratruocData.giatri_conlai)))]),e("div",{staticClass:"form-label"},[a._v("Số tháng phân bổ:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatNumber(a.chiphiTratruocData.so_thang_phan_bo)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Kỳ phân bổ:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ky_phanbo||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Số tháng phân bổ:")]),e("div",{staticClass:"form-value amount"},[a._v(a._s(a.formatNumber(a.chiphiTratruocData.sothang_phanbo)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("TK phân bổ:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.taikhoan_phanbo||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Mã kho CT:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ma_kho_ct||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Mã nhóm CT:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.ma_nhom_ct||"N/A"))]),e("div",{staticClass:"form-label"},[a._v("Chi tiết TK phân bổ:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.chitiet_taikhoan_phanbo||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Công đoạn sản xuất:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.chiphiTratruocData.congdoan_sanxuat||"N/A"))])]),e("div",{staticClass:"section-title"},[a._v("Trạng thái")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Trạng thái:")]),e("div",{staticClass:"form-value"},[e("el-tag",{attrs:{type:1===a.chiphiTratruocData.trang_thai?"success":"danger"}},[a._v(" "+a._s(1===a.chiphiTratruocData.trang_thai?"Hoạt động":"Vô hiệu hóa")+" ")])],1),e("div",{staticClass:"form-label"},[a._v("Ngày tạo:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.formatDate(a.chiphiTratruocData.created_at)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[a._v("Ngày cập nhật:")]),e("div",{staticClass:"form-value"},[a._v(a._s(a.formatDate(a.chiphiTratruocData.updated_at)))])])]):e("div",{staticClass:"loading-container"},[e("el-empty",{attrs:{description:"Không có dữ liệu"}})],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:a.handleClose}},[a._v("Đóng")])],1)])},g=[],v={name:"ChiphiTratruocDetail",props:{visible:{type:Boolean,default:!1},chiphiTratruocData:{type:Object,default:function(){return{}}}},methods:{formatCurrency:function(a){return null===a||void 0===a?"0 VND":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a)},formatNumber:function(a){return null===a||void 0===a?"0":new Intl.NumberFormat("vi-VN").format(a)},formatDate:function(a){if(!a)return"N/A";var t=new Date(a);return t.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},handleClose:function(){this.$emit("update:visible",!1),this.$emit("close")}}},D=v,k=(e("6706"),Object(d["a"])(D,b,g,!1,null,"e09fb59c",null)),y=k.exports,C="http://localhost:8080/api",T={name:"DmChiphiTratruocList",components:{ChiphiTratruocForm:_,ChiphiTratruocDetail:y},data:function(){return{searchQuery:"",chiphiTratruocList:[],loading:!1,pagination:{page:1,pageSize:10,total:0},formDialog:{visible:!1,isEdit:!1,chiphiTratruocData:{}},detailDialog:{visible:!1,chiphiTratruocData:{}}}},methods:{fetchChiphiTratruoc:function(){var a=this;return Object(s["a"])(Object(r["a"])().m((function t(){var e,o,i;return Object(r["a"])().w((function(t){while(1)switch(t.n){case 0:return a.loading=!0,t.p=1,e={table_code:"tbldmchiphi_tratruoc",mst:a.searchQuery||void 0,sohieutk:a.searchQuery||void 0,ma_kho:a.searchQuery||void 0,ten_taisan:a.searchQuery||void 0,page:a.pagination.page,pageSize:a.pagination.pageSize},t.n=2,l["a"].post("".concat(C,"/dm/search"),e);case 2:o=t.v,console.log("API result:",o),a.chiphiTratruocList=o.data.items||[],a.pagination.total=o.data.total||0,t.n=4;break;case 3:t.p=3,i=t.v,console.error("Error fetching data:",i),a.chiphiTratruocList=[],a.pagination.total=0,a.$message.error("Có lỗi xảy ra khi tải dữ liệu");case 4:return t.p=4,a.loading=!1,t.f(4);case 5:return t.a(2)}}),t,null,[[1,3,4,5]])})))()},handleSearch:function(){this.pagination.page=1,this.fetchChiphiTratruoc()},handlePageChange:function(a){this.pagination.page=a,this.fetchChiphiTratruoc()},indexMethod:function(a){return(this.pagination.page-1)*this.pagination.pageSize+a+1},formatDate:function(a){return a?new Date(a).toLocaleDateString("vi-VN"):""},formatNumber:function(a){return null===a||void 0===a?"":new Intl.NumberFormat("vi-VN").format(a)},formatCurrency:function(a){return null===a||void 0===a?"":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a)},openCreateDialog:function(){this.formDialog={visible:!0,isEdit:!1,chiphiTratruocData:{}}},openEditDialog:function(a){this.formDialog={visible:!0,isEdit:!0,chiphiTratruocData:Object(n["a"])({},a)}},handleFormSuccess:function(a){this.fetchChiphiTratruoc(),this.$message.success(this.formDialog.isEdit?"Cập nhật thành công":"Thêm mới thành công")},handleFormClose:function(){this.formDialog={visible:!1,isEdit:!1,chiphiTratruocData:{}}},openDetailDialog:function(a){this.detailDialog={visible:!0,chiphiTratruocData:Object(n["a"])({},a)}},handleDetailClose:function(){this.detailDialog={visible:!1,chiphiTratruocData:{}}},handleDisable:function(a){var t=this;return Object(s["a"])(Object(r["a"])().m((function e(){var o,i;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,t.$confirm('Bạn có chắc chắn muốn vô hiệu hóa chi phí trả trước "'.concat(a.ten_taisan,'" (').concat(a.ma_taisan,")?"),"Xác nhận vô hiệu hóa",{confirmButtonText:"Vô hiệu hóa",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--danger"});case 1:return t.loading=!0,o={table_code:"tbldmchiphi_tratruoc",sohieutk:a.sohieutk,ma_kho:a.ma_kho,ma_nhom:a.ma_nhom,ma_taisan:a.ma_taisan,trang_thai:0},e.n=2,l["a"].post("".concat(C,"/dm/update-status"),o);case 2:t.$message.success("Vô hiệu hóa chi phí trả trước thành công"),t.fetchChiphiTratruoc(),e.n=4;break;case 3:e.p=3,i=e.v,"cancel"!==i&&(console.error("Error disabling chiphi tratruoc:",i),t.$message.error("Có lỗi xảy ra khi vô hiệu hóa chi phí trả trước"));case 4:return e.p=4,t.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()},handleEnable:function(a){var t=this;return Object(s["a"])(Object(r["a"])().m((function e(){var o,i;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,t.$confirm('Bạn có chắc chắn muốn kích hoạt chi phí trả trước "'.concat(a.ten_taisan,'" (').concat(a.ma_taisan,")?"),"Xác nhận kích hoạt",{confirmButtonText:"Kích hoạt",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--success"});case 1:return t.loading=!0,o={table_code:"tbldmchiphi_tratruoc",sohieutk:a.sohieutk,ma_kho:a.ma_kho,ma_nhom:a.ma_nhom,ma_taisan:a.ma_taisan,trang_thai:1},e.n=2,l["a"].post("".concat(C,"/dm/update-status"),o);case 2:t.$message.success("Kích hoạt chi phí trả trước thành công"),t.fetchChiphiTratruoc(),e.n=4;break;case 3:e.p=3,i=e.v,"cancel"!==i&&(console.error("Error enabling chiphi tratruoc:",i),t.$message.error("Có lỗi xảy ra khi kích hoạt chi phí trả trước"));case 4:return e.p=4,t.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()}},created:function(){this.fetchChiphiTratruoc()}},w=T,x=(e("03e8"),Object(d["a"])(w,o,i,!1,null,"f57d1448",null));t["default"]=x.exports},"487a":function(a,t,e){"use strict";e("cede")},"5cc7":function(a,t,e){},6706:function(a,t,e){"use strict";e("814c")},"814c":function(a,t,e){},cede:function(a,t,e){}}]);