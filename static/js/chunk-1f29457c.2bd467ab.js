(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f29457c"],{4729:function(t,a,e){},"507c":function(t,a,e){},"5e25":function(t,a,e){"use strict";e("d1f7")},"5ff8":function(t,a,e){},6308:function(t,a,e){"use strict";e("4729")},"71fb":function(t,a,e){"use strict";e("5ff8")},"95fb":function(t,a,e){},abc5:function(t,a,e){"use strict";e("dd94")},d1f7:function(t,a,e){},dd94:function(t,a,e){},ecf9:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"taikhoan-container"},[e("el-card",[e("div",{staticStyle:{"margin-bottom":"20px",display:"flex",gap:"10px","align-items":"center","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex",gap:"10px","align-items":"center"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"Nhập số hiệu hoặc tên tài khoản để tìm kiếm",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleSearch(a)}},model:{value:t.searchQuery,callback:function(a){t.searchQuery=a},expression:"searchQuery"}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("Search")])],1),e("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:t.openCreateDialog}},[t._v("Thêm mới")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.accounts,border:"","empty-text":"Không có dữ liệu","max-height":"600"}},[e("el-table-column",{attrs:{label:"STT",type:"index",width:"60",index:t.indexMethod,align:"center"}}),t._e(),e("el-table-column",{attrs:{prop:"sohieutk",label:"Số hiệu TK",width:"120"}}),e("el-table-column",{attrs:{prop:"ten_tk",label:"Tên tài khoản","min-width":"100"}}),e("el-table-column",{attrs:{prop:"du_no_dau_ky",label:"Dư nợ đầu kỳ",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatCurrency(a.row.du_no_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"du_co_dau_ky",label:"Dư có đầu kỳ",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatCurrency(a.row.du_co_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"trang_thai",label:"Trạng thái",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:1===a.row.trang_thai?"success":"danger"}},[t._v(" "+t._s(1===a.row.trang_thai?"Hoạt động":"Vô hiệu")+" ")])]}}])}),e("el-table-column",{attrs:{label:"Tài khoản chi tiết",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{staticStyle:{cursor:"pointer","font-size":"12px","font-weight":"bold"},attrs:{type:"primary"},on:{click:function(e){return t.openSubAccountDrawer(a.row)}}},[t._v(" Tài khoản chi tiết ("),e("span",{staticClass:"highlight-ct"},[t._v(t._s(a.row.total_tk_ct))]),t._v(") ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"Action",width:"350"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-info"},on:{click:function(e){return t.openDetailDialog(a.row)}}},[t._v("Detail")]),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(e){return t.openEditDialog(a.row)}}},[t._v("Edit")]),e("el-button",{attrs:{type:1===a.row.trang_thai?"danger":"warning",size:"small",icon:1===a.row.trang_thai?"el-icon-delete":"el-icon-check"},on:{click:function(e){1===a.row.trang_thai?t.handleDisable(a.row):t.handleEnable(a.row)}}},[t._v(t._s(1===a.row.trang_thai?"Disable":"Enable"))])]}}])})],1),e("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":t.pagination.page,"page-size":t.pagination.pageSize,total:t.pagination.total},on:{"current-change":t.handlePageChange}})],1)],1),e("AccountForm",{attrs:{visible:t.formDialog.visible,"is-edit":t.formDialog.isEdit,"account-data":t.formDialog.accountData},on:{"update:visible":function(a){return t.$set(t.formDialog,"visible",a)},success:t.handleFormSuccess,close:t.handleFormClose}}),e("AccountDetail",{attrs:{visible:t.detailDialog.visible,"account-data":t.detailDialog.accountData},on:{"update:visible":function(a){return t.$set(t.detailDialog,"visible",a)},close:t.handleDetailClose}}),e("el-drawer",{attrs:{visible:t.subAccountDrawer.visible,size:"55%"},on:{"update:visible":function(a){return t.$set(t.subAccountDrawer,"visible",a)},close:t.closeSubAccountDrawer}},[e("div",{staticClass:"custom-drawer-title"},[t._v(" Danh sách tài khoản chi tiết của "),e("span",[t._v(t._s(t.subAccountDrawer.ten_tk))]),t._v(" ("),e("span",{staticClass:"sohieutk-highlight"},[t._v(t._s(t.subAccountDrawer.sohieutk))]),t._v(") ")]),e("div",{staticClass:"drawer-content-padding"},[e("div",{staticStyle:{"margin-bottom":"20px",display:"flex",gap:"10px","align-items":"center","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex",gap:"10px","align-items":"center"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Nhập số hiệu hoặc tên chi tiết để tìm kiếm",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchSubAccounts(a)}},model:{value:t.subAccountDrawer.searchQuery,callback:function(a){t.$set(t.subAccountDrawer,"searchQuery",a)},expression:"subAccountDrawer.searchQuery"}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.fetchSubAccounts}},[t._v("Search")])],1),e("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(a){return t.openSubAccountForm(!1)}}},[t._v("Thêm mới")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.subAccountDrawer.loading,expression:"subAccountDrawer.loading"}],staticStyle:{width:"100%"},attrs:{data:t.subAccountDrawer.accounts,border:"","empty-text":"Không có dữ liệu","max-height":"400"}},[e("el-table-column",{attrs:{prop:"ma_chitiet",label:"Mã chi tiết",width:"120"}}),e("el-table-column",{attrs:{prop:"ten_chitiet",label:"Tên chi tiết","min-width":"180"}}),e("el-table-column",{attrs:{prop:"du_no_dau_ky",label:"Dư nợ đầu kỳ",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatCurrency(a.row.du_no_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"du_co_dau_ky",label:"Dư có đầu kỳ",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatCurrency(a.row.du_co_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"trang_thai",label:"Trạng thái",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:1===a.row.trang_thai?"success":"danger"}},[t._v(" "+t._s(1===a.row.trang_thai?"Hoạt động":"Vô hiệu")+" ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"Action",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-btn-group"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(e){return t.openSubAccountForm(!0,a.row)}}},[t._v("Sửa")]),e("el-button",{attrs:{type:1===a.row.trang_thai?"danger":"warning",size:"small",icon:1===a.row.trang_thai?"el-icon-delete":"el-icon-check"},on:{click:function(e){1===a.row.trang_thai?t.handleDisableSubAccount(a.row):t.handleEnableSubAccount(a.row)}}},[t._v(t._s(1===a.row.trang_thai?"Disable":"Enable"))])],1)]}}])})],1),e("div",{staticClass:"balance-pagination-row"},[e("div",{staticClass:"total-balance-info"},[e("div",{staticClass:"balance-block"},[e("span",{staticClass:"balance-label"},[t._v("Tổng dư nợ đầu kỳ:")]),e("el-input",{staticClass:"balance-input debit",on:{input:t.onInputDuNo},model:{value:t.formattedDuNo,callback:function(a){t.formattedDuNo=a},expression:"formattedDuNo"}})],1),e("div",{staticClass:"balance-block"},[e("span",{staticClass:"balance-label"},[t._v("Tổng dư có đầu kỳ:")]),e("el-input",{staticClass:"balance-input credit",on:{input:t.onInputDuCo},model:{value:t.formattedDuCo,callback:function(a){t.formattedDuCo=a},expression:"formattedDuCo"}})],1)]),e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":t.subAccountDrawer.pagination.page,"page-size":t.subAccountDrawer.pagination.pageSize,total:t.subAccountDrawer.pagination.total},on:{"current-change":t.handleSubAccountPageChange}})],1),t.subAccountDrawer.showForm?e("div",{staticStyle:{"margin-top":"24px",background:"#fafbfc",padding:"24px","border-radius":"8px"}},[e("el-form",{ref:"subAccountForm",attrs:{model:t.subAccountDrawer.formData,rules:t.subAccountDrawer.rules,"label-width":"120px","label-position":"left"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"MST",prop:"mst"}},[e("el-input",{attrs:{placeholder:"MST",clearable:"",readonly:""},model:{value:t.subAccountDrawer.formData.mst,callback:function(a){t.$set(t.subAccountDrawer.formData,"mst",a)},expression:"subAccountDrawer.formData.mst"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số hiệu TK",prop:"sohieutk"}},[e("el-input",{attrs:{placeholder:"Số hiệu tài khoản",clearable:"",readonly:""},model:{value:t.subAccountDrawer.formData.sohieutk,callback:function(a){t.$set(t.subAccountDrawer.formData,"sohieutk",a)},expression:"subAccountDrawer.formData.sohieutk"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã chi tiết",prop:"ma_chitiet"}},[e("el-input",{attrs:{placeholder:"Nhập mã chi tiết",clearable:""},model:{value:t.subAccountDrawer.formData.ma_chitiet,callback:function(a){t.$set(t.subAccountDrawer.formData,"ma_chitiet",a)},expression:"subAccountDrawer.formData.ma_chitiet"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Tên chi tiết",prop:"ten_chitiet"}},[e("el-input",{attrs:{placeholder:"Nhập tên chi tiết",clearable:""},model:{value:t.subAccountDrawer.formData.ten_chitiet,callback:function(a){t.$set(t.subAccountDrawer.formData,"ten_chitiet",a)},expression:"subAccountDrawer.formData.ten_chitiet"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Dư nợ đầu kỳ",prop:"du_no_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:t.subAccountDrawer.formData.du_no_dau_ky,callback:function(a){t.$set(t.subAccountDrawer.formData,"du_no_dau_ky",a)},expression:"subAccountDrawer.formData.du_no_dau_ky"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Dư có đầu kỳ",prop:"du_co_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:0,step:1e3,min:0,placeholder:"0"},model:{value:t.subAccountDrawer.formData.du_co_dau_ky,callback:function(a){t.$set(t.subAccountDrawer.formData,"du_co_dau_ky",a)},expression:"subAccountDrawer.formData.du_co_dau_ky"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Trạng thái",prop:"trang_thai"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"Hoạt động","inactive-text":"Vô hiệu"},model:{value:t.subAccountDrawer.formData.trang_thai,callback:function(a){t.$set(t.subAccountDrawer.formData,"trang_thai",a)},expression:"subAccountDrawer.formData.trang_thai"}})],1)],1)],1),e("el-form-item",{attrs:{label:"Ghi chú",prop:"ghi_chu"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"Nhập ghi chú (nếu có)"},model:{value:t.subAccountDrawer.formData.ghi_chu,callback:function(a){t.$set(t.subAccountDrawer.formData,"ghi_chu",a)},expression:"subAccountDrawer.formData.ghi_chu"}})],1)],1),e("div",{staticStyle:{"text-align":"left","margin-top":"16px"}},[e("el-button",{on:{click:t.closeSubAccountForm}},[t._v("Hủy")]),e("el-button",{attrs:{type:"primary",loading:t.subAccountDrawer.formLoading},on:{click:t.submitSubAccountForm}},[t._v(" "+t._s(t.subAccountDrawer.isEdit?"Cập nhật":"Thêm mới")+" ")])],1)],1):t._e()],1)])],1)},c=[],o=e("5530"),i=e("c14f"),r=e("1da1"),u=(e("99af"),e("a9e3"),e("ac1f"),e("5319"),e("b775")),s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-dialog",{attrs:{title:t.isEdit?"Chỉnh sửa tài khoản":"Thêm mới tài khoản",visible:t.dialogVisible,width:"1100px","before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(a){t.dialogVisible=a}}},[e("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"220px","label-position":"left"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"MST",prop:"mst"}},[e("el-input",{attrs:{placeholder:"MST",readonly:""},model:{value:t.formData.mst,callback:function(a){t.$set(t.formData,"mst",a)},expression:"formData.mst"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số hiệu TK",prop:"sohieutk"}},[e("el-input",{attrs:{placeholder:"Nhập số hiệu tài khoản",clearable:""},model:{value:t.formData.sohieutk,callback:function(a){t.$set(t.formData,"sohieutk",a)},expression:"formData.sohieutk"}})],1)],1)],1),e("el-form-item",{attrs:{label:"Tên tài khoản",prop:"ten_tk"}},[e("el-input",{attrs:{placeholder:"Nhập tên tài khoản",clearable:""},model:{value:t.formData.ten_tk,callback:function(a){t.$set(t.formData,"ten_tk",a)},expression:"formData.ten_tk"}})],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Tên tài khoản TA",prop:"ten_tk_ta"}},[e("el-input",{attrs:{placeholder:"Nhập tên tài khoản TA",clearable:""},model:{value:t.formData.ten_tk_ta,callback:function(a){t.$set(t.formData,"ten_tk_ta",a)},expression:"formData.ten_tk_ta"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Dư nợ đầu kỳ",prop:"du_no_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.formData.du_no_dau_ky,callback:function(a){t.$set(t.formData,"du_no_dau_ky",a)},expression:"formData.du_no_dau_ky"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Dư có đầu kỳ",prop:"du_co_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.formData.du_co_dau_ky,callback:function(a){t.$set(t.formData,"du_co_dau_ky",a)},expression:"formData.du_co_dau_ky"}})],1)],1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("Hủy")]),e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v(" "+t._s(t.isEdit?"Cập nhật":"Thêm mới")+" ")])],1)],1)},l=[],h=(e("b64b"),"http://localhost:8080/api"),d={name:"AccountForm",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},accountData:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,formData:{mst:"",sohieutk:"",ten_tk:"",ten_tk_ta:"",du_no_dau_ky:0,du_co_dau_ky:0},rules:{sohieutk:[{required:!0,message:"Vui lòng nhập số hiệu tài khoản",trigger:"blur"}],ten_tk:[{required:!0,message:"Vui lòng nhập tên tài khoản",trigger:"blur"}]}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{visible:function(t){t&&this.initForm()}},methods:{initForm:function(){var t=this,a="";try{var e=JSON.parse(localStorage.getItem("user"));a=(null===e||void 0===e?void 0:e.mst)||""}catch(n){}this.isEdit&&this.accountData?this.formData={mst:this.accountData.mst||a,sohieutk:this.accountData.sohieutk||"",ten_tk:this.accountData.ten_tk||"",ten_tk_ta:this.accountData.ten_tk_ta||"",du_no_dau_ky:this.accountData.du_no_dau_ky||0,du_co_dau_ky:this.accountData.du_co_dau_ky||0}:(this.formData={mst:a,sohieutk:"",ten_tk:"",ten_tk_ta:"",du_no_dau_ky:0,du_co_dau_ky:0},this.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate()})))},resetForm:function(){var t=this,a="";try{var e=JSON.parse(localStorage.getItem("user"));a=(null===e||void 0===e?void 0:e.mst)||""}catch(n){}this.formData={mst:a,sohieutk:"",ten_tk:"",ten_tk_ta:"",du_no_dau_ky:0,du_co_dau_ky:0},this.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate()}))},handleSubmit:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){var e,n,c;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:return a.p=0,a.n=1,t.$refs.form.validate();case 1:if(e=a.v,e){a.n=2;break}return a.a(2);case 2:if(t.loading=!0,n={table_code:"tbldmtaikhoan",mst:t.formData.mst,sohieutk:t.formData.sohieutk,ten_tk:t.formData.ten_tk,ten_tk_ta:t.formData.ten_tk_ta,du_no_dau_ky:t.formData.du_no_dau_ky,du_co_dau_ky:t.formData.du_co_dau_ky},!t.isEdit){a.n=4;break}return n.id=t.accountData.id,a.n=3,u["a"].post("".concat(h,"/dm/upsert"),n);case 3:a.n=5;break;case 4:return a.n=5,u["a"].post("".concat(h,"/dm/upsert"),n);case 5:t.$emit("success",t.formData),t.handleClose(),a.n=7;break;case 6:a.p=6,c=a.v,console.error("Error submitting form:",c),t.$message.error("Có lỗi xảy ra khi lưu dữ liệu");case 7:return a.p=7,t.loading=!1,a.f(7);case 8:return a.a(2)}}),a,null,[[0,6,7,8]])})))()},handleClose:function(){this.$emit("close"),this.resetForm()}}},m=d,b=(e("6308"),e("2877")),f=Object(b["a"])(m,s,l,!1,null,"6705f1f4",null),p=f.exports,_=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-dialog",{attrs:{title:"Chi tiết tài khoản",visible:t.dialogVisible,width:"1000px","before-close":t.handleClose},on:{"update:visible":function(a){t.dialogVisible=a}}},[t.accountData?e("div",{staticClass:"account-detail-form"},[e("div",{staticClass:"section-title"},[t._v("Thông tin tài khoản")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("MST:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.accountData.mst||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Số hiệu TK:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.accountData.sohieutk||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Tên tài khoản:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.accountData.ten_tk||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Tên tài khoản TA:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.accountData.ten_tk_ta||"N/A"))])]),e("div",{staticClass:"section-title"},[t._v("Số dư đầu kỳ")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Dư nợ đầu kỳ:")]),e("div",{staticClass:"form-value amount debit"},[t._v(t._s(t.formatCurrency(t.accountData.du_no_dau_ky)))]),e("div",{staticClass:"form-label"},[t._v("Dư có đầu kỳ:")]),e("div",{staticClass:"form-value amount credit"},[t._v(t._s(t.formatCurrency(t.accountData.du_co_dau_ky)))])])]):e("div",{staticClass:"loading-container"},[e("el-empty",{attrs:{description:"Không có dữ liệu"}})],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("Đóng")])],1)])},g=[],D={name:"AccountDetail",props:{visible:{type:Boolean,default:!1},accountData:{type:Object,default:function(){return{}}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{formatCurrency:function(t){return null===t||void 0===t?"0 VND":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)},formatDate:function(t){if(!t)return"N/A";var a=new Date(t);return a.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},handleClose:function(){this.$emit("close")}}},k=D,w=(e("f100"),Object(b["a"])(k,_,g,!1,null,"1dab5164",null)),v=w.exports,y="http://localhost:8080/api",A={name:"DmTaiKhoanList",components:{AccountForm:p,AccountDetail:v},data:function(){return{searchQuery:"",accounts:[],loading:!1,pagination:{page:1,pageSize:10,total:0},formDialog:{visible:!1,isEdit:!1,accountData:{}},detailDialog:{visible:!1,accountData:{}},subAccountDrawer:{visible:!1,title:"",sohieutk:"",mst:"",searchQuery:"",accounts:[],loading:!1,pagination:{page:1,pageSize:10,total:0},isEdit:!1,currentRecord:{},showForm:!1,formData:{mst:"",sohieutk:"",ma_chitiet:"",ten_chitiet:"",du_no_dau_ky:0,du_co_dau_ky:0,trang_thai:1,ghi_chu:""},rules:{mst:[{required:!0,message:"Vui lòng nhập MST",trigger:"blur"}],sohieutk:[{required:!0,message:"Vui lòng nhập số hiệu tài khoản",trigger:"blur"}],ma_chitiet:[{required:!0,message:"Vui lòng nhập mã chi tiết",trigger:"blur"}],ten_chitiet:[{required:!0,message:"Vui lòng nhập tên chi tiết",trigger:"blur"}]},formLoading:!1,totalDuNoDauKy:0,totalDuCoDauKy:0},formattedDuNo:"",formattedDuCo:""}},watch:{"subAccountDrawer.totalDuNoDauKy":{immediate:!0,handler:function(t){this.formattedDuNo=this.formatVND(t)}},"subAccountDrawer.totalDuCoDauKy":{immediate:!0,handler:function(t){this.formattedDuCo=this.formatVND(t)}}},methods:{fetchAccounts:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){var e,n,c;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:return t.loading=!0,a.p=1,e={table_code:"tbldmtaikhoan",sohieutk:t.searchQuery||void 0,ten_tk:t.searchQuery||void 0,page:t.pagination.page,pageSize:t.pagination.pageSize},a.n=2,u["a"].post("".concat(y,"/dm/search"),e);case 2:n=a.v,console.log("API result:",n),t.accounts=n.data.items||[],t.pagination.total=n.data.total||0,a.n=4;break;case 3:a.p=3,c=a.v,console.error("Error fetching data:",c),t.accounts=[],t.pagination.total=0,t.$message.error("Có lỗi xảy ra khi tải dữ liệu");case 4:return a.p=4,t.loading=!1,a.f(4);case 5:return a.a(2)}}),a,null,[[1,3,4,5]])})))()},handleSearch:function(){this.pagination.page=1,this.fetchAccounts()},handlePageChange:function(t){this.pagination.page=t,this.fetchAccounts()},indexMethod:function(t){return(this.pagination.page-1)*this.pagination.pageSize+t+1},formatCurrency:function(t){return null===t||void 0===t?"":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)},openCreateDialog:function(){this.formDialog={visible:!0,isEdit:!1,accountData:{}}},openEditDialog:function(t){this.formDialog={visible:!0,isEdit:!0,accountData:Object(o["a"])({},t)}},handleFormSuccess:function(t){this.fetchAccounts(),this.$message.success(this.formDialog.isEdit?"Cập nhật thành công":"Thêm mới thành công")},handleFormClose:function(){this.formDialog={visible:!1,isEdit:!1,accountData:{}}},openDetailDialog:function(t){this.detailDialog={visible:!0,accountData:Object(o["a"])({},t)}},handleDetailClose:function(){this.detailDialog={visible:!1,accountData:{}}},handleDisable:function(t){var a=this;return Object(r["a"])(Object(i["a"])().m((function e(){var n,c;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn vô hiệu hóa tài khoản "'.concat(t.ten_tk,'" (').concat(t.sohieutk,")?"),"Xác nhận vô hiệu hóa",{confirmButtonText:"Vô hiệu hóa",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--danger"});case 1:return a.loading=!0,n={table_code:"tbldmtaikhoan",mst:t.mst,sohieutk:t.sohieutk,trang_thai:0},e.n=2,u["a"].post("".concat(y,"/dm/update-status"),n);case 2:a.$message.success("Vô hiệu hóa tài khoản thành công"),a.fetchAccounts(),e.n=4;break;case 3:e.p=3,c=e.v,"cancel"!==c&&(console.error("Error disabling account:",c),a.$message.error("Có lỗi xảy ra khi vô hiệu hóa tài khoản"));case 4:return e.p=4,a.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()},handleEnable:function(t){var a=this;return Object(r["a"])(Object(i["a"])().m((function e(){var n,c;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn kích hoạt tài khoản "'.concat(t.ten_tk,'" (').concat(t.sohieutk,")?"),"Xác nhận kích hoạt",{confirmButtonText:"Kích hoạt",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--success"});case 1:return a.loading=!0,n={table_code:"tbldmtaikhoan",mst:t.mst,sohieutk:t.sohieutk,trang_thai:1},e.n=2,u["a"].post("".concat(y,"/dm/update-status"),n);case 2:a.$message.success("Kích hoạt tài khoản thành công"),a.fetchAccounts(),e.n=4;break;case 3:e.p=3,c=e.v,"cancel"!==c&&(console.error("Error enabling account:",c),a.$message.error("Có lỗi xảy ra khi kích hoạt tài khoản"));case 4:return e.p=4,a.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()},openSubAccountDrawer:function(t){this.subAccountDrawer.visible=!0,this.subAccountDrawer.ten_tk=t.ten_tk,this.subAccountDrawer.sohieutk=t.sohieutk,this.subAccountDrawer.mst=t.mst,this.subAccountDrawer.searchQuery="",this.subAccountDrawer.pagination.page=1,this.fetchSubAccounts(),this.fetchSubAccountBalance()},closeSubAccountDrawer:function(){this.subAccountDrawer.visible=!1},fetchSubAccounts:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){var e,n;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:return t.subAccountDrawer.loading=!0,a.p=1,e={table_code:"tbldmtaikhoan_chitiet",sohieutk:t.subAccountDrawer.sohieutk,ten_chitiet:t.subAccountDrawer.searchQuery||void 0,page:t.subAccountDrawer.pagination.page,pageSize:t.subAccountDrawer.pagination.pageSize},a.n=2,u["a"].post("".concat(y,"/dm/search"),e);case 2:n=a.v,t.subAccountDrawer.accounts=n.data.items||[],t.subAccountDrawer.pagination.total=n.data.total||0,a.n=4;break;case 3:a.p=3,a.v,t.subAccountDrawer.accounts=[],t.subAccountDrawer.pagination.total=0,t.$message.error("Có lỗi xảy ra khi tải tài khoản chi tiết");case 4:return a.p=4,t.subAccountDrawer.loading=!1,a.f(4);case 5:return a.a(2)}}),a,null,[[1,3,4,5]])})))()},handleSubAccountPageChange:function(t){this.subAccountDrawer.pagination.page=t,this.fetchSubAccounts()},subAccountIndexMethod:function(t){return(this.subAccountDrawer.pagination.page-1)*this.subAccountDrawer.pagination.pageSize+t+1},openSubAccountForm:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.subAccountDrawer.isEdit=t,this.subAccountDrawer.formData=t&&a?{mst:a.mst||"",sohieutk:a.sohieutk||"",ma_chitiet:a.ma_chitiet||"",ten_chitiet:a.ten_chitiet||"",du_no_dau_ky:a.du_no_dau_ky||0,du_co_dau_ky:a.du_co_dau_ky||0,trang_thai:null!=a.trang_thai?a.trang_thai:1,ghi_chu:a.ghi_chu||""}:{mst:this.subAccountDrawer.mst||"",sohieutk:this.subAccountDrawer.sohieutk||"",ma_chitiet:"",ten_chitiet:"",du_no_dau_ky:0,du_co_dau_ky:0,trang_thai:1,ghi_chu:""},this.subAccountDrawer.showForm=!0},closeSubAccountForm:function(){this.subAccountDrawer.showForm=!1,this.$refs.subAccountForm&&this.$refs.subAccountForm.resetFields()},submitSubAccountForm:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:t.$refs.subAccountForm.validate(function(){var a=Object(r["a"])(Object(i["a"])().m((function a(e){var n;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:if(e){a.n=1;break}return a.a(2);case 1:return t.subAccountDrawer.formLoading=!0,a.p=2,n=Object(o["a"])({table_code:"tbldmtaikhoan_chitiet"},t.subAccountDrawer.formData),n.trang_thai=t.subAccountDrawer.formData.trang_thai?1:0,a.n=3,u["a"].post("".concat(y,"/dm/upsert"),n);case 3:return t.$message.success(t.subAccountDrawer.isEdit?"Cập nhật thành công":"Thêm mới thành công"),t.subAccountDrawer.showForm=!1,a.n=4,t.fetchSubAccounts();case 4:return a.n=5,t.fetchSubAccountBalance();case 5:return a.n=6,t.updateMainAccountBalance();case 6:return a.n=7,t.fetchAccounts();case 7:a.n=9;break;case 8:a.p=8,a.v,t.$message.error("Có lỗi xảy ra khi lưu dữ liệu");case 9:return a.p=9,t.subAccountDrawer.formLoading=!1,a.f(9);case 10:return a.a(2)}}),a,null,[[2,8,9,10]])})));return function(t){return a.apply(this,arguments)}}());case 1:return a.a(2)}}),a)})))()},updateMainAccountBalance:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){var e,n,c,o;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:return e=t.subAccountDrawer.totalDuNoDauKy,n=t.subAccountDrawer.totalDuCoDauKy,a.p=1,c={table_code:"tbldmtaikhoan",mst:t.subAccountDrawer.formData.mst||t.subAccountDrawer.accounts[0]&&t.subAccountDrawer.accounts[0].mst||"",sohieutk:t.subAccountDrawer.sohieutk,du_no_dau_ky:e,du_co_dau_ky:n},a.n=2,u["a"].post("".concat(y,"/dm/taikhoan/update-balance"),c);case 2:a.n=4;break;case 3:a.p=3,o=a.v,console.error("Lỗi cập nhật dư nợ/có tài khoản chính:",o);case 4:return a.a(2)}}),a,null,[[1,3]])})))()},handleSubAccountFormSuccess:function(){this.subAccountDrawer.showForm=!1,this.fetchSubAccounts(),this.fetchAccounts()},fetchSubAccountBalance:function(){var t=this;return Object(r["a"])(Object(i["a"])().m((function a(){var e,n;return Object(i["a"])().w((function(a){while(1)switch(a.n){case 0:return a.p=0,e={sohieutk:t.subAccountDrawer.sohieutk,table_code:"tbldmtaikhoan_chitiet"},a.n=1,u["a"].post("".concat(y,"/dm/taikhoan-chitiet/get-balance"),e);case 1:n=a.v,console.log("API /dm/taikhoan-chitiet/get-balance result:",n),n.data?(t.subAccountDrawer.totalDuNoDauKy=n.data.du_no_dau_ky||0,t.subAccountDrawer.totalDuCoDauKy=n.data.du_co_dau_ky||0):(t.subAccountDrawer.totalDuNoDauKy=0,t.subAccountDrawer.totalDuCoDauKy=0),a.n=3;break;case 2:a.p=2,a.v,t.subAccountDrawer.totalDuNoDauKy=0,t.subAccountDrawer.totalDuCoDauKy=0;case 3:return a.a(2)}}),a,null,[[0,2]])})))()},handleDisableSubAccount:function(t){var a=this;return Object(r["a"])(Object(i["a"])().m((function e(){var n,c;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn vô hiệu hóa tài khoản chi tiết "'.concat(t.ten_chitiet,'" (').concat(t.ma_chitiet,")?"),"Xác nhận vô hiệu hóa",{confirmButtonText:"Vô hiệu hóa",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--danger"});case 1:return a.subAccountDrawer.loading=!0,n={table_code:"tbldmtaikhoan_chitiet",mst:t.mst,sohieutk:t.sohieutk,ma_chitiet:t.ma_chitiet,trang_thai:0},e.n=2,u["a"].post("".concat(y,"/dm/update-status"),n);case 2:return a.$message.success("Vô hiệu hóa tài khoản chi tiết thành công"),a.fetchSubAccounts(),e.n=3,a.fetchSubAccountBalance();case 3:return e.n=4,a.updateMainAccountBalance();case 4:a.fetchAccounts(),e.n=6;break;case 5:e.p=5,c=e.v,"cancel"!==c&&a.$message.error("Có lỗi xảy ra khi vô hiệu hóa tài khoản chi tiết");case 6:return e.p=6,a.subAccountDrawer.loading=!1,e.f(6);case 7:return e.a(2)}}),e,null,[[0,5,6,7]])})))()},handleEnableSubAccount:function(t){var a=this;return Object(r["a"])(Object(i["a"])().m((function e(){var n,c;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn kích hoạt tài khoản chi tiết "'.concat(t.ten_chitiet,'" (').concat(t.ma_chitiet,")?"),"Xác nhận kích hoạt",{confirmButtonText:"Kích hoạt",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--success"});case 1:return a.subAccountDrawer.loading=!0,n={table_code:"tbldmtaikhoan_chitiet",mst:t.mst,sohieutk:t.sohieutk,ma_chitiet:t.ma_chitiet,trang_thai:1},e.n=2,u["a"].post("".concat(y,"/dm/update-status"),n);case 2:return a.$message.success("Kích hoạt tài khoản chi tiết thành công"),a.fetchSubAccounts(),e.n=3,a.fetchSubAccountBalance();case 3:return e.n=4,a.updateMainAccountBalance();case 4:a.fetchAccounts(),e.n=6;break;case 5:e.p=5,c=e.v,"cancel"!==c&&a.$message.error("Có lỗi xảy ra khi kích hoạt tài khoản chi tiết");case 6:return e.p=6,a.subAccountDrawer.loading=!1,e.f(6);case 7:return e.a(2)}}),e,null,[[0,5,6,7]])})))()},formatVND:function(t){return t?Number(t).toLocaleString("vi-VN")+" ₫":""},parseVND:function(t){return Number((t||"").replace(/[^\d]/g,""))||0},onInputDuNo:function(t){this.subAccountDrawer.totalDuNoDauKy=this.parseVND(t),this.formattedDuNo=this.formatVND(this.subAccountDrawer.totalDuNoDauKy)},onInputDuCo:function(t){this.subAccountDrawer.totalDuCoDauKy=this.parseVND(t),this.formattedDuCo=this.formatVND(this.subAccountDrawer.totalDuCoDauKy)}},computed:{totalDuNoDauKy:function(){return this.subAccountDrawer.totalDuNoDauKy},totalDuCoDauKy:function(){return this.subAccountDrawer.totalDuCoDauKy}},created:function(){this.fetchAccounts()}},C=A,S=(e("71fb"),e("5e25"),e("abc5"),e("f15f"),Object(b["a"])(C,n,c,!1,null,"bf531b76",null));a["default"]=S.exports},f100:function(t,a,e){"use strict";e("507c")},f15f:function(t,a,e){"use strict";e("95fb")}}]);