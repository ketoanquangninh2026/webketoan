(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ca26e5c"],{"12b7":function(t,a,e){"use strict";e("5e65")},"1db4":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"vattu-hanghoa-container"},[e("el-card",[e("div",{staticStyle:{"margin-bottom":"20px",display:"flex",gap:"10px","align-items":"center","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex",gap:"10px","align-items":"center"}},[e("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"Nhập MST, số hiệu TK hoặc tên vật tư để tìm kiếm",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleSearch(a)}},model:{value:t.searchQuery,callback:function(a){t.searchQuery=a},expression:"searchQuery"}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("Tìm kiếm")])],1),e("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(a){return t.openDialog("create")}}},[t._v(" Thêm mới ")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.materials,border:"","empty-text":"Không có dữ liệu","max-height":"600"}},[e("el-table-column",{attrs:{label:"STT",type:"index",width:"60",index:t.indexMethod,align:"center"}}),e("el-table-column",{attrs:{prop:"mst",label:"MST",width:"120"}}),e("el-table-column",{attrs:{prop:"sohieutk",label:"Số hiệu TK",width:"120"}}),e("el-table-column",{attrs:{prop:"ma_kho",label:"Mã kho",width:"100"}}),e("el-table-column",{attrs:{prop:"ma_nhom",label:"Mã nhóm",width:"100"}}),e("el-table-column",{attrs:{prop:"ma_vattu",label:"Mã vật tư",width:"120"}}),e("el-table-column",{attrs:{prop:"ten_vattu",label:"Tên vật tư","min-width":"200"}}),e("el-table-column",{attrs:{prop:"dvt",label:"Đơn vị tính",width:"100"}}),e("el-table-column",{attrs:{prop:"luong_dau_ky",label:"Lượng đầu kỳ",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatNumber(a.row.luong_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"gia_tri_dau_ky",label:"Giá trị đầu kỳ",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatCurrency(a.row.gia_tri_dau_ky))+" ")]}}])}),e("el-table-column",{attrs:{prop:"he_so_quy_doi",label:"Hệ số quy đổi",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatNumber(a.row.he_so_quy_doi))+" ")]}}])}),e("el-table-column",{attrs:{prop:"ma_don_vi_quy_doi",label:"Mã đơn vị quy đổi",width:"140"}}),e("el-table-column",{attrs:{prop:"vi_tri_luu_tru",label:"Vị trí lưu trữ","min-width":"150"}}),e("el-table-column",{attrs:{prop:"nam",label:"Năm",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatNumber(a.row.nam))+" ")]}}])}),e("el-table-column",{attrs:{prop:"trang_thai",label:"Trạng thái",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:1===a.row.trang_thai?"success":"danger"}},[t._v(" "+t._s(1===a.row.trang_thai?"Hoạt động":"Vô hiệu hóa")+" ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"Action",width:"280",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticClass:"el-icon-info",attrs:{type:"success",size:"small"},on:{click:function(e){return t.onDetail(a.row)}}},[t._v("Detail")]),e("el-button",{staticClass:"el-icon-edit",attrs:{type:"primary",size:"small"},on:{click:function(e){return t.openDialog("update",a.row)}}},[t._v("Edit")]),e("el-button",{class:1===a.row.trang_thai?"el-icon-delete":"el-icon-check",attrs:{type:1===a.row.trang_thai?"danger":"warning",size:"small"},on:{click:function(e){1===a.row.trang_thai?t.handleDisable(a.row):t.handleEnable(a.row)}}},[t._v(t._s(1===a.row.trang_thai?"Disable":"Enable"))])]}}])})],1),e("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":t.pagination.page,"page-size":t.pagination.pageSize,total:t.pagination.total},on:{"current-change":t.handlePageChange}})],1)],1),e("MaterialForm",{directives:[{name:"show",rawName:"v-show",value:t.dialogVisible&&("create"===t.dialogType||"update"===t.dialogType),expression:"dialogVisible && (dialogType === 'create' || dialogType === 'update')"}],attrs:{visible:t.dialogVisible,"is-edit":"update"===t.dialogType,"material-data":t.selectedMaterial},on:{"update:visible":function(a){t.dialogVisible=a},success:t.onFormSuccess,close:t.closeDialog}}),e("MaterialDetail",{attrs:{visible:t.detailVisible,"material-data":t.selectedMaterial},on:{"update:visible":function(a){t.detailVisible=a},close:t.closeDetail}})],1)},l=[],r=e("5530"),n=e("c14f"),o=e("1da1"),s=(e("99af"),e("b775")),c=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-dialog",{attrs:{title:t.isEdit?"Chỉnh sửa vật tư":"Thêm mới vật tư",visible:t.visible,width:"1000px","before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(a){t.visible=a}}},[t.formLoading?e("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center","min-height":"200px"}},[e("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"32px","margin-right":"8px"}}),t._v(" Đang tải dữ liệu... ")]):e("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"140px","label-position":"left"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"MST",prop:"mst"}},[e("el-input",{attrs:{placeholder:"Nhập MST",clearable:""},model:{value:t.formData.mst,callback:function(a){t.$set(t.formData,"mst",a)},expression:"formData.mst"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Số hiệu TK",prop:"sohieutk"}},[e("el-input",{attrs:{placeholder:"Nhập số hiệu TK",clearable:""},model:{value:t.formData.sohieutk,callback:function(a){t.$set(t.formData,"sohieutk",a)},expression:"formData.sohieutk"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã kho",prop:"ma_kho"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn mã kho",clearable:"",filterable:""},on:{change:t.handleMaKhoChange},model:{value:t.formData.ma_kho,callback:function(a){t.$set(t.formData,"ma_kho",a)},expression:"formData.ma_kho"}},t._l(t.khoOptions,(function(t,a){return e("el-option",{key:"makho-"+t.ma_kho+"-"+a,attrs:{label:t.ma_kho+" - "+t.ten_kho,value:t.ma_kho}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã nhóm",prop:"ma_nhom"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn mã nhóm",clearable:"",filterable:""},on:{change:t.handleMaNhomChange},model:{value:t.formData.ma_nhom,callback:function(a){t.$set(t.formData,"ma_nhom",a)},expression:"formData.ma_nhom"}},t._l(t.nhomOptions,(function(t,a){return e("el-option",{key:"manhom-"+t.ma_nhom+"-"+a,attrs:{label:t.ma_nhom+" - "+t.ten_nhom,value:t.ma_nhom}})})),1)],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã vật tư",prop:"ma_vattu"}},[e("el-input",{attrs:{placeholder:"Nhập mã vật tư",clearable:""},model:{value:t.formData.ma_vattu,callback:function(a){t.$set(t.formData,"ma_vattu",a)},expression:"formData.ma_vattu"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Tên vật tư",prop:"ten_vattu"}},[e("el-input",{attrs:{placeholder:"Nhập tên vật tư",clearable:""},model:{value:t.formData.ten_vattu,callback:function(a){t.$set(t.formData,"ten_vattu",a)},expression:"formData.ten_vattu"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Đơn vị tính",prop:"dvt"}},[e("el-input",{attrs:{placeholder:"Nhập đơn vị tính",clearable:""},model:{value:t.formData.dvt,callback:function(a){t.$set(t.formData,"dvt",a)},expression:"formData.dvt"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Năm",prop:"nam"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:2e3,max:2100,placeholder:"Năm"},model:{value:t.formData.nam,callback:function(a){t.$set(t.formData,"nam",a)},expression:"formData.nam"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Lượng đầu kỳ",prop:"luong_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,placeholder:"0"},model:{value:t.formData.luong_dau_ky,callback:function(a){t.$set(t.formData,"luong_dau_ky",a)},expression:"formData.luong_dau_ky"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Giá trị đầu kỳ",prop:"gia_tri_dau_ky"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,placeholder:"0"},model:{value:t.formData.gia_tri_dau_ky,callback:function(a){t.$set(t.formData,"gia_tri_dau_ky",a)},expression:"formData.gia_tri_dau_ky"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Hệ số quy đổi",prop:"he_so_quy_doi"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,placeholder:"0"},model:{value:t.formData.he_so_quy_doi,callback:function(a){t.$set(t.formData,"he_so_quy_doi",a)},expression:"formData.he_so_quy_doi"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Mã đơn vị quy đổi",prop:"ma_don_vi_quy_doi"}},[e("el-input",{attrs:{placeholder:"Nhập mã đơn vị quy đổi",clearable:""},model:{value:t.formData.ma_don_vi_quy_doi,callback:function(a){t.$set(t.formData,"ma_don_vi_quy_doi",a)},expression:"formData.ma_don_vi_quy_doi"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Trạng thái",prop:"trang_thai"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"Hoạt động","inactive-text":"Ngừng hoạt động"},model:{value:t.formData.trang_thai,callback:function(a){t.$set(t.formData,"trang_thai",a)},expression:"formData.trang_thai"}})],1)],1)],1),e("el-form-item",{attrs:{label:"Vị trí lưu trữ",prop:"vi_tri_luu_tru"}},[e("el-input",{attrs:{placeholder:"Nhập vị trí lưu trữ",clearable:""},model:{value:t.formData.vi_tri_luu_tru,callback:function(a){t.$set(t.formData,"vi_tri_luu_tru",a)},expression:"formData.vi_tri_luu_tru"}})],1),e("el-form-item",{attrs:{label:"Ghi chú",prop:"ghi_chu"}},[e("el-input",{attrs:{type:"textarea",rows:2,placeholder:"Nhập ghi chú (nếu có)"},model:{value:t.formData.ghi_chu,callback:function(a){t.$set(t.formData,"ghi_chu",a)},expression:"formData.ghi_chu"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("Hủy")]),e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v(" "+t._s(t.isEdit?"Cập nhật":"Thêm mới")+" ")])],1)],1)},u=[],m=(e("d3b7"),e("0643"),e("4e3e"),e("159b"),"http://localhost:8080/api"),h={name:"MaterialForm",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},materialData:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,formLoading:!1,khoOptions:[],nhomOptions:[],formData:{mst:"",sohieutk:"",ma_kho:"",ma_nhom:"",ma_vattu:"",ten_vattu:"",dvt:"",luong_dau_ky:0,gia_tri_dau_ky:0,he_so_quy_doi:0,ma_don_vi_quy_doi:"",vi_tri_luu_tru:"",nam:(new Date).getFullYear(),ghi_chu:"",trang_thai:1},rules:{mst:[{required:!0,message:"Vui lòng nhập MST",trigger:"blur"}],sohieutk:[{required:!0,message:"Vui lòng nhập số hiệu TK",trigger:"blur"}],ma_kho:[{required:!0,message:"Vui lòng chọn mã kho",trigger:"change"}],ma_nhom:[{required:!0,message:"Vui lòng chọn mã nhóm",trigger:"change"}],ma_vattu:[{required:!0,message:"Vui lòng nhập mã vật tư",trigger:"blur"}],ten_vattu:[{required:!0,message:"Vui lòng nhập tên vật tư",trigger:"blur"}],trang_thai:[{required:!0,message:"Vui lòng chọn trạng thái",trigger:"change"}]}}},watch:{visible:function(t){var a=this;return Object(o["a"])(Object(n["a"])().m((function e(){return Object(n["a"])().w((function(e){while(1)switch(e.n){case 0:if(!t){e.n=2;break}return a.formLoading=!0,e.n=1,a.initForm();case 1:a.formLoading=!1;case 2:return e.a(2)}}),e)})))()},"formData.mst":function(t){this.isEdit||(this.formData.ma_kho="",this.formData.ma_nhom="",this.nhomOptions=[])},"formData.sohieutk":function(t){this.isEdit||(this.formData.ma_kho="",this.formData.ma_nhom="",this.nhomOptions=[])},"formData.ma_kho":function(t){t&&this.formData.mst&&this.formData.sohieutk&&this.loadNhomOptions(this.formData.mst,this.formData.sohieutk,t),this.isEdit||(this.formData.ma_nhom="")}},methods:{loadKhoOptions:function(t,a){var e=this;return Object(o["a"])(Object(n["a"])().m((function i(){var l,o;return Object(n["a"])().w((function(i){while(1)switch(i.n){case 0:return i.p=0,l={table_code:"tbldmkhohang",size:1e3,page:1},t&&(l.filters={mst:t}),a&&(l.filters=Object(r["a"])(Object(r["a"])({},l.filters),{},{sohieutk:a})),i.n=1,s["a"].post("".concat(m,"/dm/get-list"),l);case 1:o=i.v,e.khoOptions=o.data&&o.data.items?o.data.items:[],i.n=3;break;case 2:i.p=2,i.v,e.$message.error("Không thể tải danh sách kho");case 3:return i.a(2)}}),i,null,[[0,2]])})))()},loadNhomOptions:function(t,a,e){var i=this;return Object(o["a"])(Object(n["a"])().m((function l(){var r;return Object(n["a"])().w((function(l){while(1)switch(l.n){case 0:if(t&&a&&e){l.n=1;break}return i.nhomOptions=[],l.a(2);case 1:return l.p=1,l.n=2,s["a"].post("".concat(m,"/dm/get-list"),{table_code:"tbldmnhomhang",size:1e3,page:1,filters:{mst:t,sohieutk:a,ma_kho:e}});case 2:r=l.v,i.nhomOptions=r.data&&r.data.items?r.data.items:[],l.n=4;break;case 3:l.p=3,l.v,i.$message.error("Không thể tải danh sách nhóm");case 4:return l.a(2)}}),l,null,[[1,3]])})))()},handleMaKhoChange:function(){this.formData.ma_nhom="",this.loadNhomOptions(this.formData.mst,this.formData.sohieutk,this.formData.ma_kho)},handleMaNhomChange:function(){},initForm:function(){var t=this;return Object(o["a"])(Object(n["a"])().m((function a(){return Object(n["a"])().w((function(a){while(1)switch(a.n){case 0:if(!t.isEdit||!t.materialData){a.n=2;break}if(t.formData={mst:t.materialData.mst||"",sohieutk:t.materialData.sohieutk||"",ma_kho:t.materialData.ma_kho||"",ma_nhom:t.materialData.ma_nhom||"",ma_vattu:t.materialData.ma_vattu||"",ten_vattu:t.materialData.ten_vattu||"",dvt:t.materialData.dvt||"",luong_dau_ky:t.materialData.luong_dau_ky||0,gia_tri_dau_ky:t.materialData.gia_tri_dau_ky||0,he_so_quy_doi:t.materialData.he_so_quy_doi||0,ma_don_vi_quy_doi:t.materialData.ma_don_vi_quy_doi||"",vi_tri_luu_tru:t.materialData.vi_tri_luu_tru||"",nam:t.materialData.nam||(new Date).getFullYear(),ghi_chu:t.materialData.ghi_chu||"",trang_thai:null!=t.materialData.trang_thai?t.materialData.trang_thai:1},!t.formData.ma_kho){a.n=1;break}return a.n=1,t.loadNhomOptions(t.formData.mst,t.formData.sohieutk,t.formData.ma_kho);case 1:a.n=3;break;case 2:return t.resetForm(),a.n=3,t.loadKhoOptions();case 3:t.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate()}));case 4:return a.a(2)}}),a)})))()},resetForm:function(){var t=this;this.formData={mst:"",sohieutk:"",ma_kho:"",ma_nhom:"",ma_vattu:"",ten_vattu:"",dvt:"",luong_dau_ky:0,gia_tri_dau_ky:0,he_so_quy_doi:0,ma_don_vi_quy_doi:"",vi_tri_luu_tru:"",nam:(new Date).getFullYear(),ghi_chu:"",trang_thai:1},this.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate()}))},handleSubmit:function(){var t=this;return Object(o["a"])(Object(n["a"])().m((function a(){var e,i,l;return Object(n["a"])().w((function(a){while(1)switch(a.n){case 0:return a.p=0,a.n=1,t.$refs.form.validate();case 1:if(e=a.v,e){a.n=2;break}return a.a(2);case 2:if(t.loading=!0,i=Object(r["a"])({table_code:"tbldmvattu_hanghoa"},t.formData),l=["trang_thai"],l.forEach((function(a){i[a]=t.formData[a]?1:0})),!t.isEdit){a.n=4;break}return i.id=t.materialData.id,a.n=3,s["a"].post("".concat(m,"/dm/upsert"),i);case 3:a.n=5;break;case 4:return a.n=5,s["a"].post("".concat(m,"/dm/upsert"),i);case 5:t.$emit("success",t.formData),a.n=7;break;case 6:a.p=6,a.v,t.$message.error("Có lỗi xảy ra khi lưu dữ liệu!");case 7:return a.p=7,t.loading=!1,a.f(7);case 8:return a.a(2)}}),a,null,[[0,6,7,8]])})))()},handleClose:function(){this.$emit("close")}}},d=h,_=(e("12b7"),e("2877")),f=Object(_["a"])(d,c,u,!1,null,"0d9913f0",null),v=f.exports,p=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-dialog",{attrs:{title:"Chi tiết vật tư",visible:t.dialogVisible,width:"1000px","before-close":t.handleClose},on:{"update:visible":function(a){t.dialogVisible=a}}},[t.materialData?e("div",{staticClass:"material-detail-form"},[e("div",{staticClass:"section-title"},[t._v("Thông tin chung")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("MST:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.mst||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Số hiệu TK:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.sohieutk||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Mã kho:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.ma_kho||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Mã nhóm:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.ma_nhom||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Mã vật tư:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.ma_vattu||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Tên vật tư:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.ten_vattu||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Đơn vị tính:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.dvt||"N/A"))]),e("div",{staticClass:"form-label"},[t._v("Năm:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.nam||"N/A"))])]),e("div",{staticClass:"section-title"},[t._v("Thông tin đầu kỳ")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Lượng đầu kỳ:")]),e("div",{staticClass:"form-value amount"},[t._v(t._s(t.formatNumber(t.materialData.luong_dau_ky)))]),e("div",{staticClass:"form-label"},[t._v("Giá trị đầu kỳ:")]),e("div",{staticClass:"form-value amount"},[t._v(t._s(t.formatCurrency(t.materialData.gia_tri_dau_ky)))])]),e("div",{staticClass:"section-title"},[t._v("Thông tin quy đổi")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Hệ số quy đổi:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.formatNumber(t.materialData.he_so_quy_doi)))]),e("div",{staticClass:"form-label"},[t._v("Mã đơn vị quy đổi:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.materialData.ma_don_vi_quy_doi||"N/A"))])]),e("div",{staticClass:"section-title"},[t._v("Thông tin lưu trữ & ghi chú")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Vị trí lưu trữ:")]),e("div",{staticClass:"form-value",staticStyle:{"grid-column":"span 3"}},[t._v(t._s(t.materialData.vi_tri_luu_tru||"N/A"))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Ghi chú:")]),e("div",{staticClass:"form-value",staticStyle:{"grid-column":"span 3"}},[t._v(t._s(t.materialData.ghi_chu||"Không có ghi chú"))])]),e("div",{staticClass:"section-title"},[t._v("Trạng thái & ngày tạo/cập nhật")]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Trạng thái:")]),e("div",{staticClass:"form-value"},[e("el-tag",{attrs:{type:1===t.materialData.trang_thai?"success":"danger"}},[t._v(" "+t._s(1===t.materialData.trang_thai?"Hoạt động":"Vô hiệu hóa")+" ")])],1),e("div",{staticClass:"form-label"},[t._v("Ngày tạo:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.formatDate(t.materialData.created_at)))])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-label"},[t._v("Ngày cập nhật:")]),e("div",{staticClass:"form-value"},[t._v(t._s(t.formatDate(t.materialData.updated_at)))])])]):e("div",{staticClass:"loading-container"},[e("el-empty",{attrs:{description:"Không có dữ liệu"}})],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("Đóng")])],1)])},g=[],b={name:"MaterialDetail",props:{visible:{type:Boolean,default:!1},materialData:{type:Object,default:function(){return{}}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{formatCurrency:function(t){return null===t||void 0===t?"0 VND":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)},formatNumber:function(t){return null===t||void 0===t?"":new Intl.NumberFormat("vi-VN").format(t)},formatDate:function(t){if(!t)return"N/A";var a=new Date(t);return a.toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},handleClose:function(){this.$emit("close")}}},k=b,y=(e("5316"),Object(_["a"])(k,p,g,!1,null,"ad8f12d0",null)),D=y.exports,w="http://localhost:8080/api",C={name:"DmVatTuHangHoaList",components:{MaterialForm:v,MaterialDetail:D},data:function(){return{searchQuery:"",materials:[],loading:!1,pagination:{page:1,pageSize:10,total:0},dialogVisible:!1,dialogType:"",detailVisible:!1,selectedMaterial:null}},methods:{fetchMaterials:function(){var t=this;return Object(o["a"])(Object(n["a"])().m((function a(){var e,i,l;return Object(n["a"])().w((function(a){while(1)switch(a.n){case 0:return t.loading=!0,a.p=1,e={table_code:"tbldmvattu_hanghoa",mst:t.searchQuery||void 0,sohieutk:t.searchQuery||void 0,ten_vattu:t.searchQuery||void 0,page:t.pagination.page,pageSize:t.pagination.pageSize},a.n=2,s["a"].post("".concat(w,"/dm/search"),e);case 2:i=a.v,console.log("API result:",i),t.materials=i.data.items||[],t.pagination.total=i.data.total||0,a.n=4;break;case 3:a.p=3,l=a.v,console.error("Error fetching data:",l),t.materials=[],t.pagination.total=0,t.$message.error("Có lỗi xảy ra khi tải dữ liệu");case 4:return a.p=4,t.loading=!1,a.f(4);case 5:return a.a(2)}}),a,null,[[1,3,4,5]])})))()},handleSearch:function(){this.pagination.page=1,this.fetchMaterials()},handlePageChange:function(t){this.pagination.page=t,this.fetchMaterials()},indexMethod:function(t){return(this.pagination.page-1)*this.pagination.pageSize+t+1},formatNumber:function(t){return null===t||void 0===t?"":new Intl.NumberFormat("vi-VN").format(t)},formatCurrency:function(t){return null===t||void 0===t?"":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)},onDetail:function(t){this.selectedMaterial=t,this.detailVisible=!0},openDialog:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dialogType=t,this.selectedMaterial="update"===t?Object(r["a"])({},a):null,this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1,this.selectedMaterial=null},closeDetail:function(){this.detailVisible=!1,this.selectedMaterial=null},onFormSuccess:function(){this.closeDialog(),this.fetchMaterials()},handleDisable:function(t){var a=this;return Object(o["a"])(Object(n["a"])().m((function e(){var i,l;return Object(n["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn vô hiệu hóa vật tư "'.concat(t.ten_vattu,'" (').concat(t.ma_vattu,")?"),"Xác nhận vô hiệu hóa",{confirmButtonText:"Vô hiệu hóa",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--danger"});case 1:return a.loading=!0,i={table_code:"tbldmvattu_hanghoa",mst:t.mst,sohieutk:t.sohieutk,ma_kho:t.ma_kho,ma_nhom:t.ma_nhom,ma_vattu:t.ma_vattu,trang_thai:0},e.n=2,s["a"].post("".concat(w,"/dm/update-status"),i);case 2:a.$message.success("Vô hiệu hóa vật tư thành công"),a.fetchMaterials(),e.n=4;break;case 3:e.p=3,l=e.v,"cancel"!==l&&a.$message.error("Có lỗi xảy ra khi vô hiệu hóa vật tư");case 4:return e.p=4,a.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()},handleEnable:function(t){var a=this;return Object(o["a"])(Object(n["a"])().m((function e(){var i,l;return Object(n["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,a.$confirm('Bạn có chắc chắn muốn kích hoạt vật tư "'.concat(t.ten_vattu,'" (').concat(t.ma_vattu,")?"),"Xác nhận kích hoạt",{confirmButtonText:"Kích hoạt",cancelButtonText:"Hủy",type:"warning",confirmButtonClass:"el-button--success"});case 1:return a.loading=!0,i={table_code:"tbldmvattu_hanghoa",mst:t.mst,sohieutk:t.sohieutk,ma_kho:t.ma_kho,ma_nhom:t.ma_nhom,ma_vattu:t.ma_vattu,trang_thai:1},e.n=2,s["a"].post("".concat(w,"/dm/update-status"),i);case 2:a.$message.success("Kích hoạt vật tư thành công"),a.fetchMaterials(),e.n=4;break;case 3:e.p=3,l=e.v,"cancel"!==l&&a.$message.error("Có lỗi xảy ra khi kích hoạt vật tư");case 4:return e.p=4,a.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()}},created:function(){this.fetchMaterials()}},x=C,N=(e("5e26"),Object(_["a"])(x,i,l,!1,null,"3290a120",null));a["default"]=N.exports},5316:function(t,a,e){"use strict";e("a749")},"5e26":function(t,a,e){"use strict";e("d650")},"5e65":function(t,a,e){},a749:function(t,a,e){},d650:function(t,a,e){}}]);